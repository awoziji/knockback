/*
  knockback-core.js 1.2.2
  Copyright (c)  2011-2017 Kevin Malakoff.
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Source: https://github.com/kmalakoff/knockback
  Dependencies: Knockout.js, Backbone.js, and Underscore.js (or LoDash.js).
  Optional dependencies: Backbone.ModelRef.js and BackboneORM.
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("backbone"),require("underscore"),require("knockout")):"function"==typeof define&&define.amd?define(["backbone","underscore","knockout"],t):"object"==typeof exports?exports.kb=t(require("backbone"),require("underscore"),require("knockout")):e.kb=t(e.Backbone,e._,e.ko)}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=23)}([function(e,t,r){"use strict";(function(t){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a="undefined"!=typeof window?window:void 0!==t?t:void 0,s=r(22),l=null,u=null,c=["release","destroy","dispose"],f=function(){function e(){i(this,e)}return o(e,null,[{key:"initClass",value:function(){this.VERSION="1.2.2",this.TYPE_UNKNOWN=0,this.TYPE_SIMPLE=1,this.TYPE_ARRAY=2,this.TYPE_MODEL=3,this.TYPE_COLLECTION=4;var e=function(e,t,r){var n=null;return s.computed(function(){n=e.apply(t,r||[])}).dispose(),n};this.ignore=s.dependencyDetection&&s.dependencyDetection.ignore?s.dependencyDetection.ignore:e}},{key:"wasReleased",value:function(e){return!e||e.__kb_released}},{key:"isReleaseable",value:function(t,r){if(null==r&&(r=0),!t||t!==Object(t)||t.__kb_released)return!1;if(s.isObservable(t)||t instanceof e.ViewModel)return!0;if("function"==typeof t||e.isModel(t)||e.isCollection(t))return!1;for(var n=0,i=c.length;n<i;n++){if("function"==typeof t[c[n]])return!0}if(r>0)return!1;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=t[o];if("__kb"!==o&&e.isReleaseable(a,r+1))return!0}return!1}},{key:"release",value:function(t){if(e.isReleaseable(t)){if(t.__kb_released=!0,l.isArray(t))return void l.each(t,function(r,n){e.isReleaseable(r)&&(t[n]=null,e.release(r))});var r=e.peek(t);if(s.isObservable(t)&&l.isArray(r))return t.__kb_is_co||t.__kb_is_o&&t.valueType()===e.TYPE_COLLECTION?void("function"==typeof t.destroy&&t.destroy()):(l.each(r,function(t,n){e.isReleaseable(t)&&(r[n]=null,e.release(t))}),void("function"==typeof t.dispose&&t.dispose()));for(var n=0,i=c.length;n<i;n++){var o=c[n];if("function"==typeof t[o])return void t[o].call(t)}s.isObservable(t)||this.releaseKeys(t)}}},{key:"releaseKeys",value:function(t){l.each(t,function(r,n){"__kb"!==n&&e.isReleaseable(r)&&(t[n]=null,e.release(r))})}},{key:"releaseOnNodeRemove",value:function(t,r){return t||e._throwUnexpected(this,"missing view model"),r||e._throwUnexpected(this,"missing node"),s.utils.domNodeDisposal.addDisposeCallback(r,function(){return e.release(t)})}},{key:"renderTemplate",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!a.document)return void("undefined"==typeof console||console.log("renderTemplate: document is undefined"));var i=a.document.createElement("div"),o=s.renderTemplate(t,r,n,i,"replaceChildren");if(1===i.childNodes.length)i=i.childNodes[0];else if(i.childNodes.length)for(var l=0,u=i.childNodes.length,c=u>=0;c?l<=u:l>=u;c?l++:l--)try{s.storedBindingContextForNode(i,s.contextFor(i.childNodes[l]));break}catch(e){}return e.releaseOnNodeRemove(r,i),o.dispose(),r.afterRender&&!n.afterRender&&r.afterRender(i),i}},{key:"applyBindings",value:function(t,r){if(!a.document)return void("undefined"==typeof console||console.log("renderTemplate: document is undefined"));if(r.length){var n=r;r=a.document.createElement("div"),l.each(n,function(e){return r.appendChild(e)})}return s.applyBindings(t,r),e.releaseOnNodeRemove(t,r),r}},{key:"getValue",value:function(t,r,i){if(t)return l.isFunction(t[r])&&(null!=e.settings.orm?e.settings.orm.useFunction(t,r):void 0)?t[r]():i?t.get.apply(t,n(l.map([r].concat(i),function(t){return e.peek(t)}))):t.get(r)}},{key:"setValue",value:function(t,r,n){var i=void 0;if(t)return l.isFunction(t[r])&&(null!=e.settings.orm?e.settings.orm.useFunction(t,r):void 0)?t[r](n):((i={})[r]=n,t.set(i))}},{key:"_throwMissing",value:function(e,t){throw new Error((l.isString(e)?e:e.constructor.name)+": "+t+" is missing")}},{key:"_throwUnexpected",value:function(e,t){throw new Error((l.isString(e)?e:e.constructor.name)+": "+t+" is unexpected")}},{key:"publishMethods",value:function(t,r,n){l.each(n,function(n){t[n]=e._.bind(r[n],r)})}},{key:"peek",value:function(t){return s.isObservable(t)?t.peek?t.peek():e.ignore(function(){return t()}):t}},{key:"isModel",value:function(t){return t&&(t instanceof e.Model||"function"==typeof t.get&&"function"==typeof t.bind)}},{key:"isCollection",value:function(t){return t&&t instanceof e.Collection}}]),e}();f.initClass(),e.exports=f,a.Parse?(f.Parse=a.Parse,u=f.Parse,f._=a.Parse._,l=f._):(f.Backbone=r(20),u=f.Backbone,f._=r(21),l=f._),f.ko=s,f.Collection=u.Collection,f.Model=u.Object||u.Model,f.Events=u.Events,f.assign=l.assign||l.extend}).call(t,r(3))},function(e,t,r){"use strict";var n=r(0),i=n._,o={default:null,"backbone-orm":null,"backbone-associations":r(18),"backbone-relational":r(19)};n.settings={orm:o.default};for(var a in o)if(Object.prototype.hasOwnProperty.call(o,a)){var s=o[a];if(s&&s.isAvailable()){n.settings.orm=s;break}}e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.each(e,function(e,t){switch(t){case"orm":if(i.isString(e)){if(!Object.prototype.hasOwnProperty.call(o,e))return void("undefined"==typeof console||console.log("Knockback configure: could not find orm: "+e+". Available: "+i.keys(o).join(", ")));var r=o[e];if(r&&!r.isAvailable())return void("undefined"==typeof console||console.log("Knockback configure: could not enable orm "+e+". Make sure it is included before Knockback"));n.settings.orm=r}else n.settings.orm=e;break;default:n.settings[t]=e}})}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=o.ko;e.exports=function(){function e(t){n(this,e),this.create_options=t,this._vo=s.observable(null)}return i(e,[{key:"destroy",value:function(){this.__kb_released=!0;var e=this.__kb_value;e&&(this.__kb_value=null,this.create_options.store&&o.utils.wrappedCreator(e)?this.create_options.store.release(e):o.release(e)),this.create_options=null}},{key:"value",value:function(){return s.utils.unwrapObservable(this._vo())}},{key:"rawValue",value:function(){return this.__kb_value}},{key:"valueType",value:function(e,t){var r=o.getValue(e,t);return this.value_type||this._updateValueObservable(r),this.value_type}},{key:"update",value:function(e){if(!this.__kb_released){void 0!==e||(e=null);var t=o.utils.valueType(e);this.__kb_value&&this.__kb_value.__kb_released&&(this.__kb_value=void 0,this.value_type=void 0);var r=this.__kb_value;switch(this.value_type){case o.TYPE_COLLECTION:if(this.value_type===o.TYPE_COLLECTION&&t===o.TYPE_ARRAY)return r(e);if(t===o.TYPE_COLLECTION||a.isNull(e))return void(e&&e instanceof o.CollectionObservable?this._updateValueObservable(o.utils.wrappedObject(e),e):o.peek(r.collection)!==e&&r.collection(e));break;case o.TYPE_MODEL:if(t===o.TYPE_MODEL||a.isNull(e))return void(e&&!o.isModel(e)?this._updateValueObservable(o.utils.wrappedObject(e),e):o.utils.wrappedObject(r)!==o.utils.resolveModel(e)&&this._updateValueObservable(e))}if(this.value_type!==t||a.isUndefined(this.value_type)){if(o.peek(r)!==e)return this._updateValueObservable(e)}else if(o.peek(r)!==e)return r(e)}}},{key:"_updateValueObservable",value:function(e,t){var r=this.create_options,n=o.utils.inferCreator(e,r.factory,r.path);null!==e||n||(this.value_type===o.TYPE_MODEL?n=o.ViewModel:this.value_type===o.TYPE_COLLECTION&&(n=o.CollectionObservable)),r.creator=n;var i=o.TYPE_UNKNOWN,l=this.__kb_value;this.__kb_value=void 0;var u=void 0;return t?(u=t,r.store&&r.store.retain(t,e,n)):n?r.store?u=r.store.retainOrCreate(e,r,!0):n.models_only?(u=e,i=o.TYPE_SIMPLE):u=n.create?n.create(e,r):new n(e,r):a.isArray(e)?(i=o.TYPE_ARRAY,u=s.observableArray(e)):(i=o.TYPE_SIMPLE,u=s.observable(e)),this.value_type=i,i===o.TYPE_UNKNOWN&&(s.isObservable(u)?u.__kb_is_co?(this.value_type=o.TYPE_COLLECTION,o.utils.wrappedObject(u,e)):this.value_type||(this.value_type=o.TYPE_SIMPLE):(this.value_type=o.TYPE_MODEL,o.utils.wrappedObject(u,o.utils.resolveModel(e)))),l&&(this.create_options.store?this.create_options.store.release(l):o.release(l)),this.__kb_value=u,this._vo(u)}}]),e}()},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=o.ko,l=["destroy","shareOptions","filters","comparator","sortAttribute","viewModelByModel","hasViewModels"];o.compare=function(e,t){return a.isString(e)?e.localeCompare(""+t):a.isString(t)?t.localeCompare(""+e):e===t?0:e<t?-1:1};var u=function(){function e(){for(var t=this,r=arguments.length,i=Array(r),u=0;u<r;u++)i[u]=arguments[u];return n(this,e),this._onCollectionChange=function(e,r){return o.ignore(function(){if(!t.in_edit&&!o.wasReleased(t))switch(e){case"reset":t.auto_compact?t.compact():t._collection.notifySubscribers(t._collection());break;case"sort":case"resort":t._collection.notifySubscribers(t._collection());break;case"new":case"add":if(!t._selectModel(r))return;var n=o.utils.wrappedObservable(t),i=t._collection();if(!~i.indexOf(r))return;if(t.viewModelByModel(r))return;t.in_edit++;var a=t._comparator();a?(n().push(t._createViewModel(r)),n.sort(a)):n.splice(i.indexOf(r),0,t._createViewModel(r)),t.in_edit--;break;case"remove":case"destroy":t._onModelRemove(r);break;case"change":if(!t._selectModel(r))return t._onModelRemove(r);if(!(t.models_only?r:t.viewModelByModel(r)))return t._onCollectionChange("add",r);var s=t._comparator();if(!s)return;t.in_edit++,o.utils.wrappedObservable(t).sort(s),t.in_edit--}})},this._onObservableArrayChange=function(e){return o.ignore(function(){var r=void 0;if(!t.in_edit){t.models_only&&e.length&&!o.isModel(e[0])&&o._throwUnexpected(t,"incorrect type passed"),t.models_only||!e.length||a.isObject(e[0])||o.isModel(e[0])||o._throwUnexpected(t,"incorrect type passed");var n=o.utils.wrappedObservable(t),i=o.peek(t._collection),s=o.peek(t._filters).length;if(i){var l=e;t.models_only?r=a.filter(e,function(e){return!s||t._selectModel(e)}):(!s||(l=[]),r=[],a.each(e,function(e){var n=o.utils.wrappedObject(e);if(s){if(!t._selectModel(n))return;l.push(e)}var i=t.create_options.store.find(n,t.create_options.creator);i&&i.constructor!==e.constructor&&o._throwUnexpected(t,"replacing different type of view model"),t.create_options.store.retain(e,n,t.create_options.creator),r.push(n)})),t.in_edit++,e.length===l.length||n(l),a.isEqual(i.models,r)||i.reset(r),t.in_edit--}}})},o.ignore(function(){var e=null;e=i[0]instanceof o.Collection?i.shift():a.isArray(i[0])?new o.Collection(i.shift()):new o.Collection,a.isFunction(i[0])&&(i[0]={view_model:i[0]});var r={};a.each(i,function(e){return o.assign(r,e)});var n=o.utils.wrappedObservable(t,s.observableArray([]));n.__kb_is_co=!0,t.in_edit=0,t.__kb||(t.__kb={}),r=o.utils.collapseOptions(r),r.auto_compact&&(t.auto_compact=!0),r.sort_attribute?t._comparator=s.observable(t._attributeComparator(r.sort_attribute)):t._comparator=s.observable(r.comparator),r.filters?t._filters=s.observableArray(a.isArray(r.filters)?r.filters:[r.filters]):t._filters=s.observableArray([]),t.create_options={store:o.Store.useOptionsOrCreate(r,e,n)};var u=t.create_options;return o.utils.wrappedObject(n,e),t.path=r.path,u.factory=o.utils.wrappedFactory(n,t._shareOrCreateFactory(r)),u.path=o.utils.pathJoin(r.path,"models"),u.creator=u.factory.creatorForPath(null,u.path),u.creator&&(t.models_only=u.creator.models_only),o.publishMethods(n,t,l),t._collection=s.observable(e),t.collection=s.computed({read:function(){return t._collection()},write:function(e){return o.ignore(function(){var r=t._collection();if(r!==e)return o.utils.wrappedObject(n,e),r&&r.unbind("all",t._onCollectionChange),e&&e.bind("all",t._onCollectionChange),t._collection(e)})}}),n.collection=t.collection,e&&e.bind("all",t._onCollectionChange),t._mapper=s.computed(function(){var e=t._comparator(),r=t._filters();r&&a.each(r,function(e){return s.utils.unwrapObservable(e)});var i=t._collection();if(!t.in_edit){n=o.utils.wrappedObservable(t);var l=void 0;i&&(l=i.models);var u=void 0;l&&0!==i.models.length?(l=a.filter(l,function(e){return!r.length||t._selectModel(e)}),u=e?a.map(l,function(e){return t._createViewModel(e)}).sort(e):t.models_only?r.length?l:l.slice():a.map(l,function(e){return t._createViewModel(e)})):u=[],t.in_edit++,n(u),t.in_edit--}}),n.subscribe(a.bind(t._onObservableArrayChange,t)),o.statistics&&o.statistics.register("CollectionObservable",t),n})}return i(e,null,[{key:"initClass",value:function(){e.extend=o.Parse?o.Parse._extend:o.Model.extend}}]),i(e,[{key:"destroy",value:function(){this.__kb_released=!0;var e=o.utils.wrappedObservable(this),t=o.peek(this._collection);if(o.utils.wrappedObject(e,null),t){t.unbind("all",this._onCollectionChange);var r=o.peek(e);r.splice(0,r.length)}this.collection.dispose(),this.collection=null,this._collection=null,e.collection=null,this._mapper.dispose(),this._mapper=null,o.release(this._filters),this._filters=null,this._comparator(null),this._comparator=null,this.create_options=null,e.collection=null,o.utils.wrappedDestroy(this),o.statistics&&o.statistics.unregister("CollectionObservable",this)}},{key:"shareOptions",value:function(){var e=o.utils.wrappedObservable(this);return{store:o.utils.wrappedStore(e),factory:o.utils.wrappedFactory(e)}}},{key:"filters",value:function(e){return e?this._filters(a.isArray(e)?e:[e]):this._filters([])}},{key:"comparator",value:function(e){return this._comparator(e)}},{key:"sortAttribute",value:function(e){return this._comparator(e?this._attributeComparator(e):null)}},{key:"viewModelByModel",value:function(e){if(this.models_only)return null;var t=Object.prototype.hasOwnProperty.call(e,e.idAttribute)?e.idAttribute:"cid";return a.find(o.peek(o.utils.wrappedObservable(this)),function(r){return r&&r.__kb&&r.__kb.object[t]===e[t]})}},{key:"hasViewModels",value:function(){return!this.models_only}},{key:"compact",value:function(){var e=this;return o.ignore(function(){var t=o.utils.wrappedObservable(e);if(o.utils.wrappedStoreIsOwned(t))return o.utils.wrappedStore(t).clear(),e._collection.notifySubscribers(e._collection())})}},{key:"_shareOrCreateFactory",value:function(e){var t=o.utils.pathJoin(e.path,"models"),r=e.factories,n=e.factory;if(n){var i=n.creatorForPath(null,t);if(i&&(!r||r.models===i)){if(!r)return n;if(n.hasPathMappings(r,e.path))return n}}return n=new o.Factory(e.factory),r&&n.addPathMappings(r,e.path),n.creatorForPath(null,t)||(Object.prototype.hasOwnProperty.call(e,"models_only")?e.models_only?n.addPathMapping(t,{models_only:!0}):n.addPathMapping(t,o.ViewModel):e.view_model?n.addPathMapping(t,e.view_model):e.create?n.addPathMapping(t,{create:e.create}):n.addPathMapping(t,o.ViewModel)),n}},{key:"_onModelRemove",value:function(e){var t=this.models_only?e:this.viewModelByModel(e);if(t){var r=o.utils.wrappedObservable(this);return this.in_edit++,r.remove(t),this.in_edit--}}},{key:"_attributeComparator",value:function(e){var t=function(t,r){var n=s.utils.unwrapObservable(e);return o.compare(t.get(n),r.get(n))};return this.models_only?t:function(e,r){return t(o.utils.wrappedModel(e),o.utils.wrappedModel(r))}}},{key:"_createViewModel",value:function(e){return this.models_only?e:this.create_options.store.retainOrCreate(e,this.create_options)}},{key:"_selectModel",value:function(e){for(var t=o.peek(this._filters),r=0,n=t.length;r<n;r++){var i=t[r];if(i=o.peek(i),a.isFunction(i)){if(!i(e))return!1}else if(a.isArray(i)){if(!~i.indexOf(e.id))return!1}else if(e.id!==i)return!1}return!0}}]),e}();u.initClass(),o.CollectionObservable=u,e.exports=u,o.collectionObservable=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(o.CollectionObservable,[null].concat(t)))},o.observableCollection=o.collectionObservable},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=o.ko;o.EventWatcher=function(){function e(t,r,i){var s=this;n(this,e),this._onModelLoaded=function(e){s.ee=e,a.each(s.__kb.callbacks,function(t,r){t.model&&t.model!==e&&s._unbindCallbacks(r,t,!0),t.model||(t.model=e,e.bind(r,t.fn)),a.each(t.list,function(t){!t.unbind_fn&&o.settings.orm&&(t.unbind_fn=o.settings.orm.bind(e,t.key,t.update,t.path)),t.emitter&&t.emitter(e)})})},this._onModelUnloaded=function(e){s.ee===e&&(s.ee=null,a.each(s.__kb.callbacks,function(e,t){return s._unbindCallbacks(t,e)}))},this._unbindCallbacks=function(e,t,r){t.model&&(t.model.unbind(e,t.fn),t.model=null),a.each(t.list,function(e){e.unbind_fn&&(e.unbind_fn(),e.unbind_fn=null),!e.emitter||r||o.wasReleased(e.obj)||e.emitter(null)})},this.__kb||(this.__kb={}),this.__kb.callbacks={},this.ee=null,i&&this.registerCallbacks(r,i),t&&this.emitter(t)}return i(e,null,[{key:"useOptionsOrCreate",value:function(e,t,r,n){return e.event_watcher?(e.event_watcher.emitter()!==t&&e.event_watcher.model_ref!==t&&o._throwUnexpected(this,"emitter not matching"),o.utils.wrappedEventWatcher(r,e.event_watcher).registerCallbacks(r,n)):(o.utils.wrappedEventWatcherIsOwned(r,!0),o.utils.wrappedEventWatcher(r,new o.EventWatcher(t)).registerCallbacks(r,n))}}]),i(e,[{key:"destroy",value:function(){return this.emitter(null),this.__kb.callbacks=null,o.utils.wrappedDestroy(this)}},{key:"emitter",value:function(e){return 0===arguments.length||this.ee===e?this.ee:(this.model_ref&&(this.model_ref.unbind("loaded",this._onModelLoaded),this.model_ref.unbind("unloaded",this._onModelUnloaded),this.model_ref.release(),this.model_ref=null),o.Backbone&&o.Backbone.ModelRef&&e instanceof o.Backbone.ModelRef?(this.model_ref=e,this.model_ref.retain(),this.model_ref.bind("loaded",this._onModelLoaded),this.model_ref.bind("unloaded",this._onModelUnloaded),e=this.model_ref.model()||null):delete this.model_ref,this.ee!==e&&(e?this._onModelLoaded(e):this._onModelUnloaded(this.ee)),e)}},{key:"registerCallbacks",value:function(e,t){var r=this;e||o._throwMissing(this,"obj"),t||o._throwMissing(this,"callback_info");var n=t.event_selector?t.event_selector.split(" "):["change"],i=this.ee;return a.each(n,function(n){if(n){var l=r.__kb.callbacks[n];l||(r.__kb.callbacks[n]={model:null,list:[],fn:function(e){a.each(l.list,function(t){t.update&&(e&&t.key&&e.hasChanged&&!e.hasChanged(s.utils.unwrapObservable(t.key))||(o.statistics&&o.statistics.addModelEvent({name:n,model:e,key:t.key,path:t.path}),t.update()))})}},l=r.__kb.callbacks[n]);var u=a.defaults({obj:e},t);l.list.push(u),i&&r._onModelLoaded(i)}}),this}},{key:"releaseCallbacks",value:function(e){var t=this;return this.ee=null,a.each(this.__kb.callbacks,function(r,n){return t._unbindCallbacks(n,r,o.wasReleased(e))}),delete this.__kb.callbacks}}]),e}(),o.emitterObservable=function(e,t){return new o.EventWatcher(e,t)}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._;o.Factory=function(){function e(t){n(this,e),this.paths={},t&&(this.parent_factory=t)}return i(e,null,[{key:"useOptionsOrCreate",value:function(e,t,r){if(e.factory&&(!e.factories||e.factories&&e.factory.hasPathMappings(e.factories,r)))return o.utils.wrappedFactory(t,e.factory);var n=o.utils.wrappedFactory(t,new o.Factory(e.factory));return e.factories&&n.addPathMappings(e.factories,r),n}}]),i(e,[{key:"hasPath",value:function(e){return!(!Object.prototype.hasOwnProperty.call(this.paths,e)||!this.parent_factory)&&this.parent_factory.hasPath(e)}},{key:"addPathMapping",value:function(e,t){this.paths[e]=t}},{key:"addPathMappings",value:function(e,t){var r=this;a.each(e,function(e,n){r.paths[o.utils.pathJoin(t,n)]=e})}},{key:"hasPathMappings",value:function(e,t){var r=!0;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=e[n],a=this.creatorForPath(null,o.utils.pathJoin(t,n));r&=a&&i===a}return r}},{key:"creatorForPath",value:function(e,t){var r=this.paths[t];return r?r.view_model?r.view_model:r:this.parent_factory?this.parent_factory.creatorForPath(e,t):null}}]),e}()},function(e,t,r){"use strict";var n=r(0);e.exports=n,n.configure=r(1),n.modules={underscore:n._,backbone:n.Parse||n.Backbone,knockout:n.ko}},function(e,t,r){"use strict";(function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i="undefined"!=typeof window?window:void 0!==e?e:void 0,o=r(0),a=o._,s=o.ko;o.RECUSIVE_AUTO_INJECT=!0,s.bindingHandlers.inject={init:function(e,t,r,n){return o.Inject.inject(s.utils.unwrapObservable(t()),n,e,t,r)}},o.Inject=function(){function e(){t(this,e)}return n(e,null,[{key:"inject",value:function(e,t,r,n,i,s){var l=function(e){return a.isFunction(e)?(t=new e(t,r,n,i),o.releaseOnNodeRemove(t,r)):(e.view_model&&(t=new e.view_model(t,r,n,i),o.releaseOnNodeRemove(t,r)),a.each(e,function(e,l){if("view_model"!==l)if("create"===l)e(t,r,n,i);else if(a.isObject(e)&&!a.isFunction(e)){var u=s||e&&e.create?{}:t;t[l]=o.Inject.inject(e,u,r,n,i,!0)}else t[l]=e})),t};return s?l(e):o.ignore(function(){return l(e)})}},{key:"injectViewModels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.document,t=[];return function e(r){if(!r.__kb_injected){var n=a.find(r.attributes||[],function(e){return"kb-inject"===e.name});n&&(r.__kb_injected=!0,t.push({el:r,view_model:{},binding:n.value}))}a.each(r.childNodes,function(t){return e(t)})}(e),a.each(t,function(e){var t={},r=null,n=null,i=e.binding;if(i){!~i.search(/[:]/)||(i="{"+i+"}");var a=new Function("","return ( "+i+" )")()||{};a.options&&(t=a.options,delete a.options),e.view_model=o.Inject.inject(a,e.view_model,e.el,null,null,!0),r=e.view_model.afterBinding||t.afterBinding,n=e.view_model.beforeBinding||t.beforeBinding}n&&n.call(e.view_model,e.view_model,e.el,t),o.applyBindings(e.view_model,e.el,t),r&&r.call(e.view_model,e.view_model,e.el,t)}),t}}]),e}();var l=s.applyBindings;if(s.applyBindings=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[1],i=o.RECUSIVE_AUTO_INJECT?o.injectViewModels(n):[];return i.length?i:l.call.apply(l,[this].concat(t))},o.injectViewModels=o.Inject.injectViewModels,i&&void 0!==i.document){!function e(){if("complete"!==i.document.readyState)return void setTimeout(e,0);o.injectViewModels()}()}}).call(t,r(3))},function(e,t,r){"use strict";var n=r(0),i=n.ko;if(i.subscribable&&i.subscribable.fn&&i.subscribable.fn.extend){var o=i.subscribable.fn.extend;i.subscribable.fn.extend=function(){for(var e=this,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=o.call(this,r);if(a!==this&&n.isReleaseable(this)){var s=a.dispose;a.dispose=function(){return null!=s&&s.apply(a,r),n.release(e)}}return a}}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(2),a=r(0),s=a._,l=a.ko,u=["value","valueType","destroy"],c=["args","read","write"];a.Observable=function(){function e(t,r,i,f){var d=this;return n(this,e),null==f&&(f={}),this._vm=f,a.ignore(function(){r||a._throwMissing(d,"key_or_info"),d.key=r.key||r,s.map(c,function(e){r[e]&&(d[e]=r[e])});var e=a.utils.collapseOptions(i),n=e.event_watcher;delete e.event_watcher,d._value=new o(e),d._model=l.observable();var f=a.utils.wrappedObservable(d,l.computed({read:function(){var e=d._model(),t=[d.key].concat(d.args||[]);s.each(t,function(e){return l.utils.unwrapObservable(e)});var r=a.utils.wrappedEventWatcher(d);return!r||r.emitter(e||null),d.read?d.update(d.read.apply(d._vm,t)):s.isUndefined(e)||a.ignore(function(){return d.update(a.getValue(e,a.peek(d.key),d.args))}),d._value.value()},write:function(e){return a.ignore(function(){var t=a.utils.unwrapModels(e),r=a.peek(d._model);return d.write?(d.write.call(d._vm,t),e=a.getValue(r,a.peek(d.key),d.args)):r&&a.setValue(r,a.peek(d.key),t),d.update(e)})},owner:d._vm}));return f.__kb_is_o=!0,e.store=a.utils.wrappedStore(f,e.store),e.path=a.utils.pathJoin(e.path,d.key),e.factories&&("function"==typeof e.factories||e.factories.create)?(e.factory=a.utils.wrappedFactory(f,new a.Factory(e.factory)),e.factory.addPathMapping(e.path,e.factories)):e.factory=a.Factory.useOptionsOrCreate(e,f,e.path),delete e.factories,a.publishMethods(f,d,u),d.model=l.computed({read:function(){return l.utils.unwrapObservable(d._model)},write:function(e){return a.ignore(function(){if(!d.__kb_released&&a.peek(d._model)!==e){var t=a.getValue(e,a.peek(d.key),d.args);return d._model(e),e?s.isUndefined(t)?void 0:d.update(t):d.update(null)}})}}),f.model=d.model,a.EventWatcher.useOptionsOrCreate({event_watcher:n},t||null,d,{emitter:d.model,update:function(){return a.ignore(function(){return d.update()})},key:d.key,path:e.path}),d._value.rawValue()||d._value.update(),a.LocalizedObservable&&r.localizer&&(f=new r.localizer(f)),a.DefaultObservable&&Object.prototype.hasOwnProperty.call(r,"default")&&(f=a.defaultObservable(f,r.default)),f})}return i(e,[{key:"destroy",value:function(){var e=a.utils.wrappedObservable(this);return this.__kb_released=!0,this._value.destroy(),this._value=null,this.model.dispose(),this.model=null,e.model=null,a.utils.wrappedDestroy(this)}},{key:"value",value:function(){return this._value.rawValue()}},{key:"valueType",value:function(){return this._value.valueType(a.peek(this._model),a.peek(this.key))}},{key:"update",value:function(e){if(!this.__kb_released)return arguments.length||(e=a.getValue(a.peek(this._model),a.peek(this.key))),this._value.update(e)}}]),e}(),a.observable=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(a.Observable,[null].concat(t)))}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=function(){function e(){n(this,e),this.model_events_tracker=[],this.registered_tracker={}}return i(e,[{key:"clear",value:function(){this.model_events_tracker=[]}},{key:"addModelEvent",value:function(e){this.model_events_tracker.push(e)}},{key:"modelEventsStatsString",value:function(){var e="";e+="Total Count: "+this.model_events_tracker.length;var t=a.groupBy(this.model_events_tracker,function(e){return"event name: '"+e.name+"', attribute name: '"+e.key+"'"});return a.each(t,function(t,r){e+="\n "+r+", count: "+t.length}),e}},{key:"register",value:function(e,t){this.registeredTracker(e).push(t)}},{key:"unregister",value:function(e,t){var r=this.registeredTracker(e),n=a.indexOf(r,t);return~n?r.splice(n,1):void("undefined"!=typeof console&&console.log("kb.Statistics: failed to unregister type: "+e))}},{key:"registeredCount",value:function(e){if(e)return this.registeredTracker(e).length;var t=0;return a.each(this.registered_tracker[e],function(e){t+=e.length}),t}},{key:"registeredStatsString",value:function(e){var t="",r=!1;return a.each(this.registered_tracker,function(e,n){e.length&&(r&&(t+="\n "),t+=(n||"No Name")+": "+e.length,r=!0)}),t||e}},{key:"registeredTracker",value:function(e){if(Object.prototype.hasOwnProperty.call(this.registered_tracker,e))return this.registered_tracker[e];var t=[];return this.registered_tracker[e]=t,t}}],[{key:"eventsStats",value:function(e,t){var r={count:0},n=e._events||e._callbacks||{},i=t?[t]:a.keys(n);return a.each(i,function(e){var t=n[e];if(t){if(a.isArray(t))r[e]=a.compact(t).length;else{var i=t,o=i.tail;for(r[e]=0,t=t.next;t!==o;)r[e]++,t=t.next}r.count+=r[e]}}),r}}]),e}();o.Statistics=s,e.exports=s},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=o.ko,l=function(){function e(){n(this,e),this.observable_records={},this.replaced_observables=[],o.Store.instances.push(this)}return i(e,null,[{key:"initClass",value:function(){e.instances=[]}},{key:"useOptionsOrCreate",value:function(e,t,r){e.store||o.utils.wrappedStoreIsOwned(r,!0);var n=o.utils.wrappedStore(r,e.store||new o.Store);return n.retain(r,t,e.creator),n}}]),i(e,[{key:"destroy",value:function(){this.__kb_released=!0,this.clear();var e=a.indexOf(o.Store.instances,this);~e&&o.Store.instances.splice(e,1)}},{key:"clear",value:function(){var e=this,t=this.observable_records;this.observable_records={},a.each(t,function(t){a.each(t,function(t){return e.release(t,!0)})});var r=this.replaced_observables;this.replaced_observables=[],a.each(r,function(t){t.__kb_released||e.release(t,!0)})}},{key:"compact",value:function(){a.each(this.observable_records,function(e){a.each(e,function(t,r){t.__kb_released&&delete e[r]})})}},{key:"retain",value:function(e,t,r){if(this._canRegister(e)){r||(r=e.constructor);var n=this.find(t,r);if(n){if(n===e)return this._getOrCreateStoreReferences(e).ref_count++,e;this._retire(n)}return this._add(e,t,r),this._getOrCreateStoreReferences(e).ref_count++,e}}},{key:"retainOrCreate",value:function(e,t,r){var n=this,i=this._creator(e,t);if(!i)return o.utils.createFromDefaultCreator(e,t);if(i.models_only)return e;var l=this.find(e,i);if(l)return r&&o.settings.deep_retain?this.retain(l,e,i):l
;if(!a.isFunction(i.create||i))throw new Error('Invalid factory for "'+t.path+'"');return l=o.ignore(function(){return t=a.defaults({store:n,creator:i},t),(l=i.create?i.create(e,t):new i(e,t))||s.observable(null)}),this.retain(l,e,i),l}},{key:"reuse",value:function(e,t){var r=o.utils.wrappedObject(e);if(r!==t){if(!this._canRegister(e))throw new Error("Cannot reuse a simple observable");if(1!==this._refCount(e))throw new Error("Trying to change a shared view model. Ref count: "+this._refCount(e));var n=o.utils.wrappedCreator(e)||e.constructor,i=void 0;a.isUndefined(r)||(i=this.find(r,n)),this.retain(e,t,n),i&&this.release(i)}}},{key:"release",value:function(e,t){if(!this._canRegister(e))return o.release(e);var r=this._storeReferences(e);if(r){if(!t&&--r.ref_count>0)return;this._clearStoreReferences(e)}return this._remove(e),e.__kb_released?void 0:t||this._refCount(e)<=1?o.release(e):void 0}},{key:"find",value:function(e,t){var r=this.observable_records[this._creatorId(t)];if(!r)return null;var n=r[this._cid(e)];return n&&n.__kb_released?(delete r[this._cid(e)],null):n}},{key:"_refCount",value:function(e){if(e.__kb_released)return"undefined"==typeof console||console.log("Observable already released"),0;var t=o.utils.get(e,"stores_references");return t?a.reduce(t,function(e,t){return e+t.ref_count},0):1}},{key:"_canRegister",value:function(e){return e&&!s.isObservable(e)&&!e.__kb_is_co}},{key:"_cid",value:function(e){return e?(e.cid||(e.cid=a.uniqueId("c")),e.cid):"null"}},{key:"_creatorId",value:function(e){var t=e.create||e;t.__kb_cids||(t.__kb_cids=[]);for(var r=0,n=t.__kb_cids.length;r<n;r++){var i=t.__kb_cids[r];if(i.create===t)return i.cid}var o={create:t,cid:a.uniqueId("kb")};return t.__kb_cids.push(o),o.cid}},{key:"_storeReferences",value:function(e){var t=this,r=o.utils.get(e,"stores_references");if(r)return a.find(r,function(e){return e.store===t})}},{key:"_getOrCreateStoreReferences",value:function(e){var t=this,r=o.utils.orSet(e,"stores_references",[]),n=a.find(r,function(e){return e.store===t});return n||r.push(n={store:this,ref_count:0,release:function(){return t.release(e)}}),n}},{key:"_clearStoreReferences",value:function(e){if(o.utils.orSet(e,"stores_references",[]))for(var t=0,r=e.__kb.stores_references.length;t<r;t++){var n=e.__kb.stores_references[t];if(n.store===this){e.__kb.stores_references.splice(t,1);break}}}},{key:"_retire",value:function(e){return this._clearStoreReferences(e),this.replaced_observables.push(e),this._remove(e)}},{key:"_add",value:function(e,t,r){r||(r=e.constructor),o.utils.wrappedObject(e,t),o.utils.wrappedCreator(e,r);var n=this._creatorId(r);return this.observable_records[n]||(this.observable_records[n]={}),this.observable_records[n][this._cid(t)]=e,e}},{key:"_remove",value:function(e){var t=o.utils.wrappedCreator(e)||e.constructor,r=o.utils.wrappedObject(e),n=this.find(r,t);return n&&n===e&&delete this.observable_records[this._creatorId(t)][this._cid(r)],o.utils.wrappedObject(e,null),o.utils.wrappedCreator(e,null)}},{key:"_creator",value:function(e,t){if(t.creator)return t.creator;var r=o.utils.inferCreator(e,t.factory,t.path);return r?r:o.isModel(e)?o.ViewModel:void 0}}]),e}();l.initClass(),o.Store=l,e.exports=l},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=o.ko,l=function(){function e(){n(this,e)}return i(e,null,[{key:"initClass",value:function(){this.wrappedDestroy=r(17),this.collapseOptions=r(15),this.unwrapModels=r(16)}},{key:"get",value:function(e,t,r){return e.__kb&&Object.prototype.hasOwnProperty.call(e.__kb,t)?e.__kb[t]:r}},{key:"set",value:function(e,t,r){return e.__kb||(e.__kb={}),e.__kb[t]=r,r}},{key:"orSet",value:function(e,t,r){return e.__kb||(e.__kb={}),Object.prototype.hasOwnProperty.call(e.__kb,t)||(e.__kb[t]=r),e.__kb[t]}},{key:"has",value:function(e,t){return e.__kb&&Object.prototype.hasOwnProperty.call(e.__kb,t)}},{key:"wrappedObservable",value:function(e,t){return 1===arguments.length?o.utils.get(e,"observable"):o.utils.set(e,"observable",t)}},{key:"wrappedObject",value:function(e,t){return 1===arguments.length?o.utils.get(e,"object"):o.utils.set(e,"object",t)}},{key:"wrappedCreator",value:function(e,t){return 1===arguments.length?o.utils.get(e,"creator"):o.utils.set(e,"creator",t)}},{key:"wrappedModel",value:function(e,t){return 1!==arguments.length?o.utils.set(e,"object",t):(t=o.utils.get(e,"object"),a.isUndefined(t)?e:t)}},{key:"wrappedStore",value:function(e,t){return 1===arguments.length?o.utils.get(e,"store"):o.utils.set(e,"store",t)}},{key:"wrappedStoreIsOwned",value:function(e,t){return 1===arguments.length?o.utils.get(e,"store_is_owned"):o.utils.set(e,"store_is_owned",t)}},{key:"wrappedFactory",value:function(e,t){return 1===arguments.length?o.utils.get(e,"factory"):o.utils.set(e,"factory",t)}},{key:"wrappedEventWatcher",value:function(e,t){return 1===arguments.length?o.utils.get(e,"event_watcher"):o.utils.set(e,"event_watcher",t)}},{key:"wrappedEventWatcherIsOwned",value:function(e,t){return 1===arguments.length?o.utils.get(e,"event_watcher_is_owned"):o.utils.set(e,"event_watcher_is_owned",t)}},{key:"valueType",value:function(e){return e?e.__kb_is_o?e.valueType():e.__kb_is_co||e instanceof o.Collection?o.TYPE_COLLECTION:e instanceof o.ViewModel||e instanceof o.Model?o.TYPE_MODEL:a.isArray(e)?o.TYPE_ARRAY:o.TYPE_SIMPLE:o.TYPE_UNKNOWN}},{key:"pathJoin",value:function(e,t){return(e?"."!==e[e.length-1]?e+".":e:"")+t}},{key:"optionsPathJoin",value:function(e,t){return a.defaults({path:this.pathJoin(e.path,t)},e)}},{key:"inferCreator",value:function(e,t,r){var n=t?t.creatorForPath(e,r):null;return n?n:e?e instanceof o.Model?o.ViewModel:e instanceof o.Collection?o.CollectionObservable:null:null}},{key:"createFromDefaultCreator",value:function(e,t){return o.isModel(e)?o.viewModel(e,t):o.isCollection(e)?o.collectionObservable(e,t):a.isArray(e)?s.observableArray(e):s.observable(e)}},{key:"resolveModel",value:function(e){return e&&o.Backbone&&o.Backbone.ModelRef&&e instanceof o.Backbone.ModelRef?e.model():e}}]),e}();l.initClass(),o.utils=l},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=o.ko,l=function(e,t){var r=e.__kb.internals&&~a.indexOf(e.__kb.internals,t)?"_"+t:t;if(!Object.prototype.hasOwnProperty.call(e.__kb.view_model,r))return e.__kb.view_model[r]=null,r},u=function(e,t,r,n){if(!(e.__kb.excludes&&~a.indexOf(e.__kb.excludes,r)||e.__kb.statics&&~a.indexOf(e.__kb.statics,r))){var i=l(e,r);if(i){var s=o.observable(t,r,n,e);return e.__kb.view_model[i]=s,e[i]=s,s}}},c=function(e,t){a.each(e.__kb.statics,function(r){var n=l(e,r);n&&(t.has(n)?(e.__kb.view_model[n]=t.get(n),e[n]=e.__kb.view_model[n]):e.__kb.static_defaults&&Object.prototype.hasOwnProperty.call(e.__kb.static_defaults,n)?(e.__kb.view_model[n]=e.__kb.static_defaults[n],e[n]=e.__kb.view_model[n]):delete e.__kb.view_model[n])})},f=["keys","internals","excludes","statics","static_defaults"],d=function(){function e(){for(var t=this,r=arguments.length,i=Array(r),l=0;l<r;l++)i[l]=arguments[l];return n(this,e),o.ignore(function(){var e=i.shift();!e||o.isModel(e)||o._throwUnexpected(t,"not a model"),a.isArray(i[0])&&(i[0]={keys:i[0]}),t.__kb||(t.__kb={}),t.__kb.view_model=i.length>1?i.pop():t;var r={};a.each(i,function(e){o.assign(r,e),r=o.utils.collapseOptions(r)}),a.each(f,function(e){Object.prototype.hasOwnProperty.call(r,e)&&(t.__kb[e]=r[e])}),o.Store.useOptionsOrCreate(r,e,t),t.__kb.path=r.path,o.Factory.useOptionsOrCreate(r,t,r.path);var n=o.utils.set(t,"_model",s.observable());t.model=s.computed({read:function(){return s.utils.unwrapObservable(n)},write:function(e){return o.ignore(function(){if(o.utils.wrappedObject(t)!==e&&!o.wasReleased(t)&&l)return t.__kb.store.reuse(t,o.utils.resolveModel(e)),l.emitter(e),n(l.ee),!l.ee||t.createObservables(l.ee)})}});var l=o.utils.wrappedEventWatcher(t,new o.EventWatcher(e,t,{emitter:t._model,update:function(){return o.ignore(function(){return!(l&&l.ee)||t.createObservables(l.ee)})}}));return e=l.ee,o.utils.wrappedObject(t,e),n(l.ee),t.__kb.create_options={store:o.utils.wrappedStore(t),factory:o.utils.wrappedFactory(t),path:t.__kb.path,event_watcher:o.utils.wrappedEventWatcher(t)},!r.requires||t.createObservables(e,r.requires),!t.__kb.internals||t.createObservables(e,t.__kb.internals),!r.mappings||t.createObservables(e,r.mappings),!t.__kb.statics||c(t,e),t.createObservables(e,t.__kb.keys),o.statistics&&o.statistics.register("ViewModel",t),t})}return i(e,null,[{key:"initClass",value:function(){e.extend=o.Parse?o.Parse._extend:o.Model.extend}}]),i(e,[{key:"destroy",value:function(){var e=this;this.__kb_released=!0,this.__kb.view_model!==this&&a.each(this.__kb.vm_keys,function(t){e.__kb.view_model[t]=null}),this.__kb.view_model=null,this.__kb.create_options=null,o.releaseKeys(this),o.utils.wrappedDestroy(this),o.statistics&&o.statistics.unregister("ViewModel",this)}},{key:"shareOptions",value:function(){return{store:o.utils.wrappedStore(this),factory:o.utils.wrappedFactory(this)}}},{key:"createObservables",value:function(e,t){var r=this;if(t)a.isArray(t)?a.map(t,function(t){return u(r,e,t,r.__kb.create_options)}):a.each(t,function(t,n){var i=l(r,n);i&&(a.isString(t)||t.key||(t.key=i),r[i]=o.observable(e,t,r.__kb.create_options,r),r.__kb.view_model[i]=r[i])});else{if(this.__kb.keys||!e)return;for(var n in e.attributes)Object.prototype.hasOwnProperty.call(e.attributes,n)&&u(this,e,n,this.__kb.create_options);o.settings.orm&&o.settings.orm.keys&&a.each(o.settings.orm.keys,function(t){return u(r,e,t,r.__kb.create_options)})}}}]),e}();d.initClass(),o.ViewModel=d,e.exports=d,o.viewModel=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(o.ViewModel,[null].concat(t)))}},function(e,t,r){"use strict";var n=r(0),i=n._,o=function(e,t,r){return e[t]||(e[t]=[]),i.isArray(r)||(r=[r]),e[t]=e[t].length?i.union(e[t],r):r,e},a=function(e,t,r){return e[t]||(e[t]={}),n.assign(e[t],r)},s=function(e){var t={};return i.each(e,function(e){t[e]={key:e}}),t},l=function e(t,r){return r?(i.each(r,function(e,r){switch(r){case"internals":case"requires":case"excludes":case"statics":o(t,r,e);break;case"keys":i.isObject(e)&&!i.isArray(e)||i.isObject(t[r])&&!i.isArray(t[r])?(i.isObject(e)||(e=[e]),i.isArray(e)&&(e=s(e)),i.isArray(t[r])&&(t[r]=s(t[r])),a(t,r,e)):o(t,r,e);break;case"factories":i.isFunction(e)?t[r]=e:a(t,r,e);break;case"static_defaults":a(t,r,e);break;case"options":break;default:t[r]=e}}),e(t,r.options)):t};e.exports=function(e){return l({},e)}},function(e,t,r){"use strict";var n=r(0),i=n._,o=function e(t){if(!t)return t;if(t.__kb)return Object.prototype.hasOwnProperty.call(t.__kb,"object")?t.__kb.object:t;if(i.isArray(t))return i.map(t,function(t){return e(t)});if(i.isObject(t)&&t.constructor==={}.constructor){var r={};return i.each(t,function(t,n){r[n]=e(t)}),r}return t};e.exports=o},function(e,t,r){"use strict";var n=function e(t){if(t.__kb){t.__kb.event_watcher&&t.__kb.event_watcher.releaseCallbacks(t);var r=t.__kb;if(t.__kb=null,r.observable&&(r.observable.destroy=null,r.observable.release=null,e(r.observable),r.observable=null),r.factory=null,r.event_watcher_is_owned&&r.event_watcher.destroy(),r.event_watcher=null,r.store_is_owned&&r.store.destroy(),r.store=null,r.stores_references)for(var n=r.stores_references.pop();n;)n.store.__kb_released||n.store.release(t),n=r.stores_references.pop()}};e.exports=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=o.Backbone,l=null;e.exports=function(){function e(){n(this,e)}return i(e,null,[{key:"isAvailable",value:function(){return!!(l=s?s.AssociatedModel:null)}},{key:"keys",value:function(e){return e instanceof l?a.map(e.relations,function(e){return e.key}):null}},{key:"relationType",value:function(e,t){if(!(e instanceof l))return null;var r=a.find(e.relations,function(e){return e.key===t});return r?"Many"===r.type?o.TYPE_COLLECTION:o.TYPE_MODEL:null}},{key:"useFunction",value:function(){return!1}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=o._,s=o.Backbone,l=null;e.exports=function(){function e(){n(this,e)}return i(e,null,[{key:"isAvailable",value:function(){return!!(l=s?s.RelationalModel:null)}},{key:"relationType",value:function(e,t){if(!(e instanceof l))return null;var r=a.find(e.getRelations(),function(e){return e.key===t});return r?r.collectionType||a.isArray(r.keyContents)?o.TYPE_COLLECTION:o.TYPE_MODEL:null}},{key:"bind",value:function(e,t,r,n){var i=this.relationType(e,t);if(!i)return null;var s=function(e){return o.statistics&&o.statistics.addModelEvent({name:"update (relational)",model:e,key:t,path:n}),r()},l=o.Backbone.Relation.prototype.sanitizeOptions?["update","add","remove"]:["change","add","remove"];return i===o.TYPE_COLLECTION?a.each(l,function(r){return e.bind(r+":"+t,s)}):e.bind(l[0]+":"+t,s),function(){i===o.TYPE_COLLECTION?a.each(l,function(r){return e.unbind(r+":"+t,s)}):e.unbind(l[0]+":"+t,s)}}},{key:"useFunction",value:function(){return!1}}]),e}()},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){r(4),r(1),r(5),r(6),r(8),r(0),r(9),r(10),r(11),r(12),r(2),r(13),r(14),e.exports=r(7)}])});