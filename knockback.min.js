/*
  knockback.js 1.2.2
  Copyright (c)  2011-2017 Kevin Malakoff.
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Source: https://github.com/kmalakoff/knockback
  Dependencies: Knockout.js, Backbone.js, and Underscore.js (or LoDash.js).
  Optional dependencies: Backbone.ModelRef.js and BackboneORM.
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("backbone"),require("underscore"),require("knockout")):"function"==typeof define&&define.amd?define(["backbone","underscore","knockout"],t):"object"==typeof exports?exports.kb=t(require("backbone"),require("underscore"),require("knockout")):e.kb=t(e.Backbone,e._,e.ko)}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=30)}([function(e,t,r){"use strict";(function(t){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o="undefined"!=typeof window?window:void 0!==t?t:void 0,s=r(29),l=null,u=null,c=["release","destroy","dispose"],f=function(){function e(){i(this,e)}return a(e,null,[{key:"initClass",value:function(){this.VERSION="1.2.2",this.TYPE_UNKNOWN=0,this.TYPE_SIMPLE=1,this.TYPE_ARRAY=2,this.TYPE_MODEL=3,this.TYPE_COLLECTION=4,this.ignore=(null!=s.dependencyDetection?s.dependencyDetection.ignore:void 0)||function(e,t,r){var n=null;return s.computed(function(){return n=e.apply(t,r||[])}).dispose(),n}}},{key:"wasReleased",value:function(e){return!e||e.__kb_released}},{key:"isReleaseable",value:function(t,r){if(null==r&&(r=0),!t||t!==Object(t)||t.__kb_released)return!1;if(s.isObservable(t)||t instanceof e.ViewModel)return!0;if("function"==typeof t||e.isModel(t)||e.isCollection(t))return!1;for(var n=0,i=c.length;n<i;n++){if("function"==typeof t[c[n]])return!0}if(r>0)return!1;for(var a in t){var o=t[a];if("__kb"!==a&&e.isReleaseable(o,r+1))return!0}return!1}},{key:"release",value:function(t){var r=void 0,n=void 0,i=void 0;if(e.isReleaseable(t)){if(t.__kb_released=!0,!l.isArray(t)){if(s.isObservable(t)&&l.isArray(r=e.peek(t))){if(t.__kb_is_co||t.__kb_is_o&&t.valueType()===e.TYPE_COLLECTION)return"function"==typeof t.destroy?t.destroy():void 0;for(n in r)i=r[n],e.isReleaseable(i)&&(r[n]=null,e.release(i));return void("function"==typeof t.dispose&&t.dispose())}for(var a=0,o=c.length;a<o;a++){var u=c[a];if("function"==typeof t[u])return t[u].call(t)}return s.isObservable(t)?void 0:this.releaseKeys(t)}for(n in t)i=t[n],e.isReleaseable(i)&&(t[n]=null,e.release(i))}}},{key:"releaseKeys",value:function(t){for(var r in t){var n=t[r];"__kb"!==r&&e.isReleaseable(n)&&(t[r]=null,e.release(n))}}},{key:"releaseOnNodeRemove",value:function(t,r){return t||e._throwUnexpected(this,"missing view model"),r||e._throwUnexpected(this,"missing node"),s.utils.domNodeDisposal.addDisposeCallback(r,function(){return e.release(t)})}},{key:"renderTemplate",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!o.document)return"undefined"!=typeof console?console.log("renderTemplate: document is undefined"):void 0;var i=o.document.createElement("div"),a=s.renderTemplate(t,r,n,i,"replaceChildren");if(1===i.childNodes.length)i=i.childNodes[0];else if(i.childNodes.length)for(var l=0,u=i.childNodes.length,c=u>=0;c?l<=u:l>=u;c?l++:l--)try{s.storedBindingContextForNode(i,s.contextFor(i.childNodes[l]));break}catch(e){}return e.releaseOnNodeRemove(r,i),a.dispose(),r.afterRender&&!n.afterRender&&r.afterRender(i),i}},{key:"applyBindings",value:function(t,r){if(!o.document)return"undefined"!=typeof console?console.log("renderTemplate: document is undefined"):void 0;if(r.length){var n=void 0,i=[o.document.createElement("div"),r];r=i[0],n=i[1],l.each(n,function(e){return r.appendChild(e)})}return s.applyBindings(t,r),e.releaseOnNodeRemove(t,r),r}},{key:"getValue",value:function(t,r,i){if(t)return l.isFunction(t[r])&&(null!=e.settings.orm?e.settings.orm.useFunction(t,r):void 0)?t[r]():i?t.get.apply(t,n(l.map([r].concat(i),function(t){return e.peek(t)}))):t.get(r)}},{key:"setValue",value:function(t,r,n){var i=void 0;if(t)return l.isFunction(t[r])&&(null!=e.settings.orm?e.settings.orm.useFunction(t,r):void 0)?t[r](n):((i={})[r]=n,t.set(i))}},{key:"_throwMissing",value:function(e,t){throw(l.isString(e)?e:e.constructor.name)+": "+t+" is missing"}},{key:"_throwUnexpected",value:function(e,t){throw(l.isString(e)?e:e.constructor.name)+": "+t+" is unexpected"}},{key:"publishMethods",value:function(t,r,n){l.each(n,function(n){t[n]=e._.bind(r[n],r)})}},{key:"peek",value:function(t){return s.isObservable(t)?t.peek?t.peek():e.ignore(function(){return t()}):t}},{key:"isModel",value:function(t){return t&&(t instanceof e.Model||"function"==typeof t.get&&"function"==typeof t.bind)}},{key:"isCollection",value:function(t){return t&&t instanceof e.Collection}}]),e}();f.initClass(),e.exports=f,o.Parse?(u=f.Parse=o.Parse,l=f._=o.Parse._):(u=f.Backbone=r(27),l=f._=r(28)),f.ko=s,f.Collection=u.Collection,f.Model=u.Object||u.Model,f.Events=u.Events,f.assign=l.assign||l.extend}).call(t,r(3))},function(e,t,r){"use strict";var n=r(0),i=n._,a={default:null,"backbone-orm":null,"backbone-associations":r(23),"backbone-relational":r(24)};n.settings={orm:a.default};for(var o in a){var s=a[o];if(s&&s.isAvailable()){n.settings.orm=s;break}}e.exports=function(e){null==e&&(e={});for(o in e){var t=e[o];switch(o){case"orm":if(i.isString(t)){if(!a.hasOwnProperty(t)){console.log("Knockback configure: could not find orm: "+t+". Available: "+i.keys(a).join(", "));continue}var r=a[t];if(r&&!r.isAvailable()){console.log("Knockback configure: could not enable orm "+t+". Make sure it is included before Knockback");continue}n.settings.orm=r}else n.settings.orm=t;break;default:n.settings[o]=t}}}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko;e.exports=function(){function e(t){n(this,e),this.create_options=t,this._vo=s.observable(null)}return i(e,[{key:"destroy",value:function(){var e=void 0;return this.__kb_released=!0,(e=this.__kb_value)&&(this.__kb_value=null,this.create_options.store&&a.utils.wrappedCreator(e)?this.create_options.store.release(e):a.release(e)),this.create_options=null}},{key:"value",value:function(){return s.utils.unwrapObservable(this._vo())}},{key:"rawValue",value:function(){return this.__kb_value}},{key:"valueType",value:function(e,t){var r=a.getValue(e,t);return this.value_type||this._updateValueObservable(r),this.value_type}},{key:"update",value:function(e){if(!this.__kb_released){void 0!==e||(e=null);var t=a.utils.valueType(e);(null!=this.__kb_value?this.__kb_value.__kb_released:void 0)&&(this.__kb_value=this.value_type=void 0);var r=this.__kb_value;switch(this.value_type){case a.TYPE_COLLECTION:if(this.value_type===a.TYPE_COLLECTION&&t===a.TYPE_ARRAY)return r(e);if(t===a.TYPE_COLLECTION||o.isNull(e))return void(e&&e instanceof a.CollectionObservable?this._updateValueObservable(a.utils.wrappedObject(e),e):a.peek(r.collection)!==e&&r.collection(e));break;case a.TYPE_MODEL:if(t===a.TYPE_MODEL||o.isNull(e))return void(e&&!a.isModel(e)?this._updateValueObservable(a.utils.wrappedObject(e),e):a.utils.wrappedObject(r)!==a.utils.resolveModel(e)&&this._updateValueObservable(e))}if(this.value_type!==t||o.isUndefined(this.value_type)){if(a.peek(r)!==e)return this._updateValueObservable(e)}else if(a.peek(r)!==e)return r(e)}}},{key:"_updateValueObservable",value:function(e,t){var r=void 0,n=void 0,i=this.create_options,l=a.utils.inferCreator(e,i.factory,i.path);null!==e||l||(this.value_type===a.TYPE_MODEL?l=a.ViewModel:this.value_type===a.TYPE_COLLECTION&&(l=a.CollectionObservable)),i.creator=l;var u=a.TYPE_UNKNOWN,c=[this.__kb_value,void 0];return r=c[0],this.__kb_value=c[1],t?(n=t,i.store&&i.store.retain(t,e,l)):l?i.store?n=i.store.retainOrCreate(e,i,!0):l.models_only?(n=e,u=a.TYPE_SIMPLE):n=l.create?l.create(e,i):new l(e,i):o.isArray(e)?(u=a.TYPE_ARRAY,n=s.observableArray(e)):(u=a.TYPE_SIMPLE,n=s.observable(e)),(this.value_type=u)===a.TYPE_UNKNOWN&&(s.isObservable(n)?n.__kb_is_co?(this.value_type=a.TYPE_COLLECTION,a.utils.wrappedObject(n,e)):this.value_type||(this.value_type=a.TYPE_SIMPLE):(this.value_type=a.TYPE_MODEL,a.utils.wrappedObject(n,a.utils.resolveModel(e)))),r&&(this.create_options.store?this.create_options.store.release(r):a.release(r)),this.__kb_value=n,this._vo(n)}},{key:"_inferType",value:function(e){}}]),e}()},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko,l=["destroy","shareOptions","filters","comparator","sortAttribute","viewModelByModel","hasViewModels"];a.compare=function(e,t){return o.isString(e)?e.localeCompare(""+t):o.isString(t)?t.localeCompare(""+e):e===t?0:e<t?-1:1};var u=function(){function e(t,r){var i=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(this,e),c.call(this);var f=Array.prototype.slice.call(o.isArguments(t)?t:arguments);return a.ignore(function(){t=f[0]instanceof a.Collection?f.shift():o.isArray(f[0])?new a.Collection(f.shift()):new a.Collection,o.isFunction(f[0])&&(f[0]={view_model:f[0]}),o.each(f,function(e){return a.assign(u,e)});var e=a.utils.wrappedObservable(i,s.observableArray([]));e.__kb_is_co=!0,i.in_edit=0,i.__kb||(i.__kb={}),u=a.utils.collapseOptions(u),u.auto_compact&&(i.auto_compact=!0),u.sort_attribute?i._comparator=s.observable(i._attributeComparator(u.sort_attribute)):i._comparator=s.observable(u.comparator),u.filters?i._filters=s.observableArray(o.isArray(u.filters)?u.filters:[u.filters]):i._filters=s.observableArray([]),i.create_options={store:a.Store.useOptionsOrCreate(u,t,e)};var r=i.create_options;return a.utils.wrappedObject(e,t),i.path=u.path,r.factory=a.utils.wrappedFactory(e,i._shareOrCreateFactory(u)),r.path=a.utils.pathJoin(u.path,"models"),r.creator=r.factory.creatorForPath(null,r.path),r.creator&&(i.models_only=r.creator.models_only),a.publishMethods(e,i,l),i._collection=s.observable(t),i.collection=s.computed({read:function(){return i._collection()},write:function(t){return a.ignore(function(){var r=void 0;if((r=i._collection())!==t)return a.utils.wrappedObject(e,t),r&&r.unbind("all",i._onCollectionChange),t&&t.bind("all",i._onCollectionChange),i._collection(t)})}}),e.collection=i.collection,t&&t.bind("all",i._onCollectionChange),i._mapper=s.computed(function(){var t=i._comparator(),r=i._filters();r&&o.each(r,function(e){return s.utils.unwrapObservable(e)});var n=i._collection();if(!i.in_edit){e=a.utils.wrappedObservable(i);var l=void 0;n&&(l=n.models);var u=void 0;l&&0!==n.models.length?(l=o.filter(l,function(e){return!r.length||i._selectModel(e)}),u=t?o.map(l,function(e){return i._createViewModel(e)}).sort(t):i.models_only?r.length?l:l.slice():o.map(l,function(e){return i._createViewModel(e)})):u=[],i.in_edit++,e(u),i.in_edit--}}),e.subscribe(o.bind(i._onObservableArrayChange,i)),a.statistics&&a.statistics.register("CollectionObservable",i),e})}return i(e,null,[{key:"initClass",value:function(){e.extend=a.Parse?a.Parse._extend:a.Model.extend}}]),i(e,[{key:"destroy",value:function(){this.__kb_released=!0;var e=a.utils.wrappedObservable(this),t=a.peek(this._collection);if(a.utils.wrappedObject(e,null),t){t.unbind("all",this._onCollectionChange);var r=a.peek(e);r.splice(0,r.length)}this.collection.dispose(),this.collection=null,this._collection=null,e.collection=null,this._mapper.dispose(),this._mapper=null,a.release(this._filters),this._filters=null,this._comparator(null),this._comparator=null,this.create_options=null,e.collection=null,a.utils.wrappedDestroy(this),a.statistics&&a.statistics.unregister("CollectionObservable",this)}},{key:"shareOptions",value:function(){var e=a.utils.wrappedObservable(this);return{store:a.utils.wrappedStore(e),factory:a.utils.wrappedFactory(e)}}},{key:"filters",value:function(e){return e?this._filters(o.isArray(e)?e:[e]):this._filters([])}},{key:"comparator",value:function(e){return this._comparator(e)}},{key:"sortAttribute",value:function(e){return this._comparator(e?this._attributeComparator(e):null)}},{key:"viewModelByModel",value:function(e){if(this.models_only)return null;var t=e.hasOwnProperty(e.idAttribute)?e.idAttribute:"cid";return o.find(a.peek(a.utils.wrappedObservable(this)),function(r){return r&&r.__kb&&r.__kb.object[t]===e[t]})}},{key:"hasViewModels",value:function(){return!this.models_only}},{key:"compact",value:function(){var e=this;return a.ignore(function(){var t=a.utils.wrappedObservable(e);if(a.utils.wrappedStoreIsOwned(t))return a.utils.wrappedStore(t).clear(),e._collection.notifySubscribers(e._collection())})}},{key:"_shareOrCreateFactory",value:function(e){var t=void 0,r=a.utils.pathJoin(e.path,"models"),n=e.factories;if(t=e.factory){var i=t.creatorForPath(null,r);if(i&&(!n||n.models===i)){if(!n)return t;if(t.hasPathMappings(n,e.path))return t}}return t=new a.Factory(e.factory),n&&t.addPathMappings(n,e.path),t.creatorForPath(null,r)||(e.hasOwnProperty("models_only")?e.models_only?t.addPathMapping(r,{models_only:!0}):t.addPathMapping(r,a.ViewModel):e.view_model?t.addPathMapping(r,e.view_model):e.create?t.addPathMapping(r,{create:e.create}):t.addPathMapping(r,a.ViewModel)),t}},{key:"_onModelRemove",value:function(e){var t=this.models_only?e:this.viewModelByModel(e);if(t){var r=a.utils.wrappedObservable(this);return this.in_edit++,r.remove(t),this.in_edit--}}},{key:"_attributeComparator",value:function(e){var t=function(t,r){var n=s.utils.unwrapObservable(e);return a.compare(t.get(n),r.get(n))};return this.models_only?t:function(e,r){return t(a.utils.wrappedModel(e),a.utils.wrappedModel(r))}}},{key:"_createViewModel",value:function(e){return this.models_only?e:this.create_options.store.retainOrCreate(e,this.create_options)}},{key:"_selectModel",value:function(e){for(var t=a.peek(this._filters),r=0,n=t.length;r<n;r++){var i=t[r];if(i=a.peek(i),o.isFunction(i)){if(!i(e))return!1}else if(o.isArray(i)){if(!~i.indexOf(e.id))return!1}else if(e.id!==i)return!1}return!0}}]),e}(),c=function(){var e=this;this._onCollectionChange=function(t,r){return a.ignore(function(){if(!e.in_edit&&!a.wasReleased(e))switch(t){case"reset":e.auto_compact?e.compact():e._collection.notifySubscribers(e._collection());break;case"sort":case"resort":e._collection.notifySubscribers(e._collection());break;case"new":case"add":if(!e._selectModel(r))return;var n=a.utils.wrappedObservable(e),i=e._collection();if(i.indexOf(r)===-1)return;if(e.viewModelByModel(r))return;e.in_edit++;var o=e._comparator();o?(n().push(e._createViewModel(r)),n.sort(o)):n.splice(i.indexOf(r),0,e._createViewModel(r)),e.in_edit--;break;case"remove":case"destroy":e._onModelRemove(r);break;case"change":if(!e._selectModel(r))return e._onModelRemove(r);if(!(e.models_only?r:e.viewModelByModel(r)))return e._onCollectionChange("add",r);var s=e._comparator();if(!s)return;e.in_edit++,a.utils.wrappedObservable(e).sort(s),e.in_edit--}})},this._onObservableArrayChange=function(t){return a.ignore(function(){var r=void 0;if(!e.in_edit){e.models_only&&(!t.length||a.isModel(t[0]))||!e.models_only&&(!t.length||o.isObject(t[0])&&!a.isModel(t[0]))||a._throwUnexpected(e,"incorrect type passed");var n=a.utils.wrappedObservable(e),i=a.peek(e._collection),s=a.peek(e._filters).length;if(i){var l=t;e.models_only?r=o.filter(t,function(t){return!s||e._selectModel(t)}):(!s||(l=[]),r=[],o.each(t,function(t){var n=void 0,i=a.utils.wrappedObject(t);if(s){if(!e._selectModel(i))return;l.push(t)}(n=e.create_options.store.find(i,e.create_options.creator))&&(n.constructor===t.constructor||a._throwUnexpected(e,"replacing different type of view model")),e.create_options.store.retain(t,i,e.create_options.creator),r.push(i)})),e.in_edit++,t.length===l.length||n(l),o.isEqual(i.models,r)||i.reset(r),e.in_edit--}}})}};u.initClass(),a.CollectionObservable=u,e.exports=u,a.collectionObservable=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(a.CollectionObservable,[null].concat(t)))},a.observableCollection=a.collectionObservable},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko;a.EventWatcher=function(){function e(t,r,i){var s=this;n(this,e),this._onModelLoaded=function(e){s.ee=e;for(var t in s.__kb.callbacks){var r=s.__kb.callbacks[t];r.model&&r.model!==e&&s._unbindCallbacks(t,r,!0),r.model||(r.model=e,e.bind(t,r.fn)),o.each(r.list,function(t){t.unbind_fn||(t.unbind_fn=null!=a.settings.orm?a.settings.orm.bind(e,t.key,t.update,t.path):void 0),t.emitter&&t.emitter(e)})}},this._onModelUnloaded=function(e){if(s.ee===e){s.ee=null;for(var t in s.__kb.callbacks){var r=s.__kb.callbacks[t];s._unbindCallbacks(t,r)}}},this._unbindCallbacks=function(e,t,r){t.model&&(t.model.unbind(e,t.fn),t.model=null),o.each(t.list,function(e){e.unbind_fn&&(e.unbind_fn(),e.unbind_fn=null),!e.emitter||r||a.wasReleased(e.obj)||e.emitter(null)})},this.__kb||(this.__kb={}),this.__kb.callbacks={},this.ee=null,i&&this.registerCallbacks(r,i),t&&this.emitter(t)}return i(e,null,[{key:"useOptionsOrCreate",value:function(e,t,r,n){return e.event_watcher?(e.event_watcher.emitter()!==t&&e.event_watcher.model_ref!==t&&a._throwUnexpected(this,"emitter not matching"),a.utils.wrappedEventWatcher(r,e.event_watcher).registerCallbacks(r,n)):(a.utils.wrappedEventWatcherIsOwned(r,!0),a.utils.wrappedEventWatcher(r,new a.EventWatcher(t)).registerCallbacks(r,n))}}]),i(e,[{key:"destroy",value:function(){return this.emitter(null),this.__kb.callbacks=null,a.utils.wrappedDestroy(this)}},{key:"emitter",value:function(e){return 0===arguments.length||this.ee===e?this.ee:(this.model_ref&&(this.model_ref.unbind("loaded",this._onModelLoaded),this.model_ref.unbind("unloaded",this._onModelUnloaded),this.model_ref.release(),this.model_ref=null),a.Backbone&&a.Backbone.ModelRef&&e instanceof a.Backbone.ModelRef?(this.model_ref=e,this.model_ref.retain(),this.model_ref.bind("loaded",this._onModelLoaded),this.model_ref.bind("unloaded",this._onModelUnloaded),e=this.model_ref.model()||null):delete this.model_ref,this.ee!==e&&(e?this._onModelLoaded(e):this._onModelUnloaded(this.ee)),e)}},{key:"registerCallbacks",value:function(e,t){var r=this;e||a._throwMissing(this,"obj"),t||a._throwMissing(this,"callback_info");var n=t.event_selector?t.event_selector.split(" "):["change"],i=this.ee;return o.each(n,function(n){if(n){var l=r.__kb.callbacks[n];l||(l=r.__kb.callbacks[n]={model:null,list:[],fn:function(e){o.each(l.list,function(t){t.update&&(e&&t.key&&e.hasChanged&&!e.hasChanged(s.utils.unwrapObservable(t.key))||(a.statistics&&a.statistics.addModelEvent({name:n,model:e,key:t.key,path:t.path}),t.update()))})}});var u=o.defaults({obj:e},t);return l.list.push(u),i?r._onModelLoaded(i):void 0}}),this}},{key:"releaseCallbacks",value:function(e){var t=void 0;this.ee=null;for(var r in this.__kb.callbacks)t=this.__kb.callbacks[r],this._unbindCallbacks(r,t,a.wasReleased(e));return delete this.__kb.callbacks}}]),e}(),a.emitterObservable=function(e,t){return new a.EventWatcher(e,t)}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._;a.Factory=function(){function e(t){n(this,e),this.paths={},t&&(this.parent_factory=t)}return i(e,null,[{key:"useOptionsOrCreate",value:function(e,t,r){if(e.factory&&(!e.factories||e.factories&&e.factory.hasPathMappings(e.factories,r)))return a.utils.wrappedFactory(t,e.factory);var n=a.utils.wrappedFactory(t,new a.Factory(e.factory));return e.factories&&n.addPathMappings(e.factories,r),n}}]),i(e,[{key:"hasPath",value:function(e){return this.paths.hasOwnProperty(e)||(null!=this.parent_factory?this.parent_factory.hasPath(e):void 0)}},{key:"addPathMapping",value:function(e,t){return this.paths[e]=t}},{key:"addPathMappings",value:function(e,t){var r=this;o.each(e,function(e,n){r.paths[a.utils.pathJoin(t,n)]=e})}},{key:"hasPathMappings",value:function(e,t){var r=!0;for(var n in e){var i=e[n],o=this.creatorForPath(null,a.utils.pathJoin(t,n));r&=o&&i===o}return r}},{key:"creatorForPath",value:function(e,t){var r=this.paths[t];return r?r.view_model?r.view_model:r:this.parent_factory?this.parent_factory.creatorForPath(e,t):null}}]),e}()},function(e,t,r){"use strict";var n=r(0);e.exports=n,n.configure=r(1),n.modules={underscore:n._,backbone:n.Parse||n.Backbone,knockout:n.ko}},function(e,t,r){"use strict";(function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i="undefined"!=typeof window?window:void 0!==e?e:void 0,a=r(0),o=a._,s=a.ko;a.RECUSIVE_AUTO_INJECT=!0,s.bindingHandlers.inject={init:function(e,t,r,n){return a.Inject.inject(s.utils.unwrapObservable(t()),n,e,t,r)}},a.Inject=function(){function e(){t(this,e)}return n(e,null,[{key:"inject",value:function e(t,r,n,i,s,l){var e=function(e){if(o.isFunction(e))r=new e(r,n,i,s),a.releaseOnNodeRemove(r,n);else{e.view_model&&(r=new e.view_model(r,n,i,s),a.releaseOnNodeRemove(r,n));for(var t in e){var u=e[t];if("view_model"!==t)if("create"===t)u(r,n,i,s);else if(o.isObject(u)&&!o.isFunction(u)){var c=l||u&&u.create?{}:r;r[t]=a.Inject.inject(u,c,n,i,s,!0)}else r[t]=u}}return r};return l?e(t):a.ignore(function(){return e(t)})}},{key:"injectViewModels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.document,t=[];return function e(r){if(!r.__kb_injected){var n=o.find(r.attributes||[],function(e){return"kb-inject"===e.name});n&&(r.__kb_injected=!0,t.push({el:r,view_model:{},binding:n.value}))}o.each(r.childNodes,function(t){return e(t)})}(e),o.each(t,function(e){var t={},r=null,n=null,i=e.binding;if(i){!~i.search(/[:]/)||(i="{"+i+"}");var o=new Function("","return ( "+i+" )")()||{};o.options&&(t=o.options,delete o.options),e.view_model=a.Inject.inject(o,e.view_model,e.el,null,null,!0),r=e.view_model.afterBinding||t.afterBinding,n=e.view_model.beforeBinding||t.beforeBinding}n&&n.call(e.view_model,e.view_model,e.el,t),a.applyBindings(e.view_model,e.el,t),r&&r.call(e.view_model,e.view_model,e.el,t)}),t}}]),e}();var l=s.applyBindings;if(s.applyBindings=function(e,t){if(!(a.RECUSIVE_AUTO_INJECT?a.injectViewModels(t):[]).length)return l.apply(this,arguments)},a.injectViewModels=a.Inject.injectViewModels,i&&void 0!==i.document){!function e(){if("complete"!==i.document.readyState)return setTimeout(e,0);a.injectViewModels()}()}}).call(t,r(3))},function(e,t,r){"use strict";var n=r(0),i=n.ko;if(i.subscribable&&i.subscribable.fn&&i.subscribable.fn.extend){var a=i.subscribable.fn.extend;i.subscribable.fn.extend=function(){var e=arguments,t=this,r=a.apply(this,arguments);if(r!==this&&n.isReleaseable(this)){var i=r.dispose;r.dispose=function(){return null!=i&&i.apply(r,e),n.release(t)}}return r}}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2),o=r(0),s=o._,l=o.ko,u=["value","valueType","destroy"],c=["args","read","write"];o.Observable=function(){function e(t,r,i,f){var d=this;return n(this,e),null==f&&(f={}),this._vm=f,o.ignore(function(){r||o._throwMissing(d,"key_or_info"),d.key=r.key||r,s.map(c,function(e){r[e]&&(d[e]=r[e])});var e=o.utils.collapseOptions(i),n=e.event_watcher;delete e.event_watcher,d._value=new a(e),d._model=l.observable();var f=o.utils.wrappedObservable(d,l.computed({read:function(){var e=d._model(),t=[d.key].concat(d.args||[]);s.each(t,function(e){return l.utils.unwrapObservable(e)});var r=o.utils.wrappedEventWatcher(d);return!r||r.emitter(e||null),d.read?d.update(d.read.apply(d._vm,t)):s.isUndefined(e)||o.ignore(function(){return d.update(o.getValue(e,o.peek(d.key),d.args))}),d._value.value()},write:function(e){return o.ignore(function(){var t=o.utils.unwrapModels(e),r=o.peek(d._model);return d.write?(d.write.call(d._vm,t),e=o.getValue(r,o.peek(d.key),d.args)):r&&o.setValue(r,o.peek(d.key),t),d.update(e)})},owner:d._vm}));return f.__kb_is_o=!0,e.store=o.utils.wrappedStore(f,e.store),e.path=o.utils.pathJoin(e.path,d.key),e.factories&&("function"==typeof e.factories||e.factories.create)?(e.factory=o.utils.wrappedFactory(f,new o.Factory(e.factory)),e.factory.addPathMapping(e.path,e.factories)):e.factory=o.Factory.useOptionsOrCreate(e,f,e.path),delete e.factories,o.publishMethods(f,d,u),f.model=d.model=l.computed({read:function(){return l.utils.unwrapObservable(d._model)},write:function(e){return o.ignore(function(){if(!d.__kb_released&&o.peek(d._model)!==e){var t=o.getValue(e,o.peek(d.key),d.args);return d._model(e),e?s.isUndefined(t)?void 0:d.update(t):d.update(null)}})}}),o.EventWatcher.useOptionsOrCreate({event_watcher:n},t||null,d,{emitter:d.model,update:function(){return o.ignore(function(){return d.update()})},key:d.key,path:e.path}),d._value.rawValue()||d._value.update(),o.LocalizedObservable&&r.localizer&&(f=new r.localizer(f)),o.DefaultObservable&&r.hasOwnProperty("default")&&(f=o.defaultObservable(f,r.default)),f})}return i(e,[{key:"destroy",value:function(){var e=o.utils.wrappedObservable(this);return this.__kb_released=!0,this._value.destroy(),this._value=null,this.model.dispose(),this.model=e.model=null,o.utils.wrappedDestroy(this)}},{key:"value",value:function(){return this._value.rawValue()}},{key:"valueType",value:function(){return this._value.valueType(o.peek(this._model),o.peek(this.key))}},{key:"update",value:function(e){if(!this.__kb_released)return arguments.length||(e=o.getValue(o.peek(this._model),o.peek(this.key))),this._value.update(e)}}]),e}(),o.observable=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(o.Observable,[null].concat(t)))}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._;e.exports=a.Statistics=function(){function e(){n(this,e),this.model_events_tracker=[],this.registered_tracker={}}return i(e,[{key:"clear",value:function(){return this.model_events_tracker=[]}},{key:"addModelEvent",value:function(e){return this.model_events_tracker.push(e)}},{key:"modelEventsStatsString",value:function(){var e="";e+="Total Count: "+this.model_events_tracker.length;var t=o.groupBy(this.model_events_tracker,function(e){return"event name: '"+e.name+"', attribute name: '"+e.key+"'"});for(var r in t){e+="\n "+r+", count: "+t[r].length}return e}},{key:"register",value:function(e,t){return this.registeredTracker(e).push(t)}},{key:"unregister",value:function(e,t){var r=this.registeredTracker(e),n=o.indexOf(r,t);return~n?r.splice(n,1):void("undefined"!=typeof console&&console.log("kb.Statistics: failed to unregister type: "+e))}},{key:"registeredCount",value:function(e){if(e)return this.registeredTracker(e).length;var t=0;for(e in this.registered_tracker[e]){t+=this.registered_tracker[e][e].length}return t}},{key:"registeredStatsString",value:function(e){var t="";for(var r in this.registered_tracker){var n=this.registered_tracker[r];if(n.length){i&&(t+="\n "),t+=(r||"No Name")+": "+n.length;var i=!0}}return t||e}},{key:"registeredTracker",value:function(e){if(this.registered_tracker.hasOwnProperty(e))return this.registered_tracker[e];var t=[];return this.registered_tracker[e]=t,t}}],[{key:"eventsStats",value:function(e,t){var r={count:0},n=e._events||e._callbacks||{},i=t?[t]:o.keys(n);return o.each(i,function(e){var t=n[e];if(t){if(o.isArray(t))r[e]=o.compact(t).length;else{r[e]=0;var i=t,a=i.tail;for(t=t.next;t!==a;)r[e]++,t=t.next}r.count+=r[e]}}),r}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko,l=function(){function e(){n(this,e),this.observable_records={},this.replaced_observables=[],a.Store.instances.push(this)}return i(e,null,[{key:"initClass",value:function(){e.instances=[]}},{key:"useOptionsOrCreate",value:function(e,t,r){e.store||a.utils.wrappedStoreIsOwned(r,!0);var n=a.utils.wrappedStore(r,e.store||new a.Store);return n.retain(r,t,e.creator),n}}]),i(e,[{key:"destroy",value:function(){this.__kb_released=!0,this.clear();var e=o.indexOf(a.Store.instances,this);if(~e)return a.Store.instances.splice(e,1)}},{key:"clear",value:function(){var e=this,t=void 0,r=void 0,n=void 0,i=[this.observable_records,{}];r=i[0],this.observable_records=i[1];for(var a in r){var s=r[a];for(var l in s)t=s[l],this.release(t,!0)}var u=[this.replaced_observables,[]];n=u[0],this.replaced_observables=u[1],o.each(n,function(t){t.__kb_released||e.release(t,!0)})}},{key:"compact",value:function(){for(var e in this.observable_records){var t=this.observable_records[e];for(var r in t)t[r].__kb_released&&delete t[r]}}},{key:"retain",value:function(e,t,r){var n=void 0;if(this._canRegister(e)){if(r||(r=e.constructor),n=this.find(t,r)){if(n===e)return this._getOrCreateStoreReferences(e).ref_count++,e;this._retire(n)}return this._add(e,t,r),this._getOrCreateStoreReferences(e).ref_count++,e}}},{key:"retainOrCreate",value:function(e,t,r){var n=this,i=void 0,l=void 0;if(!(i=this._creator(e,t)))return a.utils.createFromDefaultCreator(e,t);if(i.models_only)return e;if(l=this.find(e,i))return r&&a.settings.deep_retain?this.retain(l,e,i):l;if(!o.isFunction(i.create||i))throw new Error('Invalid factory for "'+t.path+'"');return l=a.ignore(function(){return t=o.defaults({store:n,creator:i},t),
(l=i.create?i.create(e,t):new i(e,t))||s.observable(null)}),this.retain(l,e,i),l}},{key:"reuse",value:function(e,t){var r=void 0,n=void 0;if((r=a.utils.wrappedObject(e))!==t){if(!this._canRegister(e))throw new Error("Cannot reuse a simple observable");if(1!==this._refCount(e))throw new Error("Trying to change a shared view model. Ref count: "+this._refCount(e));var i=a.utils.wrappedCreator(e)||e.constructor;o.isUndefined(r)||(n=this.find(r,i)),this.retain(e,t,i),n&&this.release(n)}}},{key:"release",value:function(e,t){var r=void 0;if(!this._canRegister(e))return a.release(e);if(r=this._storeReferences(e)){if(!t&&--r.ref_count>0)return;this._clearStoreReferences(e)}return this._remove(e),e.__kb_released?void 0:t||this._refCount(e)<=1?a.release(e):void 0}},{key:"find",value:function(e,t){var r=this.observable_records[this._creatorId(t)];if(!r)return null;var n=r[this._cid(e)];return n&&n.__kb_released?(delete r[this._cid(e)],null):n}},{key:"_refCount",value:function(e){var t=void 0;return e.__kb_released?("undefined"!=typeof console&&null!==console&&console.log("Observable already released"),0):(t=a.utils.get(e,"stores_references"))?o.reduce(t,function(e,t){return e+t.ref_count},0):1}},{key:"_canRegister",value:function(e){return e&&!s.isObservable(e)&&!e.__kb_is_co}},{key:"_cid",value:function(e){return e?e.cid||(e.cid=o.uniqueId("c")):"null"}},{key:"_creatorId",value:function(e){var t=e.create||e;t.__kb_cids||(t.__kb_cids=[]);for(var r=0,n=t.__kb_cids.length;r<n;r++){var i=t.__kb_cids[r];if(i.create===t)return i.cid}return t.__kb_cids.push(i={create:t,cid:o.uniqueId("kb")}),i.cid}},{key:"_storeReferences",value:function(e){var t=this,r=a.utils.get(e,"stores_references");if(r)return o.find(r,function(e){return e.store===t})}},{key:"_getOrCreateStoreReferences",value:function(e){var t=this,r=a.utils.orSet(e,"stores_references",[]),n=o.find(r,function(e){return e.store===t});return n||r.push(n={store:this,ref_count:0,release:function(){return t.release(e)}}),n}},{key:"_clearStoreReferences",value:function(e){if(a.utils.orSet(e,"stores_references",[]))for(var t=0,r=e.__kb.stores_references.length;t<r;t++){var n=e.__kb.stores_references[t];if(n.store===this){e.__kb.stores_references.splice(t,1);break}}}},{key:"_retire",value:function(e){return this._clearStoreReferences(e),this.replaced_observables.push(e),this._remove(e)}},{key:"_add",value:function(e,t,r){var n=void 0;return r||(r=e.constructor),a.utils.wrappedObject(e,t),a.utils.wrappedCreator(e,r),(this.observable_records[n=this._creatorId(r)]||(this.observable_records[n]={}))[this._cid(t)]=e}},{key:"_remove",value:function(e){var t=void 0,r=void 0,n=a.utils.wrappedCreator(e)||e.constructor;return(t=this.find(r=a.utils.wrappedObject(e),n))&&t===e&&delete this.observable_records[this._creatorId(n)][this._cid(r)],a.utils.wrappedObject(e,null),a.utils.wrappedCreator(e,null)}},{key:"_creator",value:function(e,t){var r=void 0;return t.creator?t.creator:(r=a.utils.inferCreator(e,t.factory,t.path))?r:a.isModel(e)?a.ViewModel:void 0}}]),e}();l.initClass(),a.Store=l,e.exports=l},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko,l=function(){function e(){n(this,e)}return i(e,null,[{key:"initClass",value:function(){this.wrappedDestroy=r(22),this.collapseOptions=r(20),this.unwrapModels=r(21)}},{key:"get",value:function(e,t,r){return e.__kb&&e.__kb.hasOwnProperty(t)?e.__kb[t]:r}},{key:"set",value:function(e,t,r){return(e.__kb||(e.__kb={}))[t]=r}},{key:"orSet",value:function(e,t,r){return e.__kb||(e.__kb={}),e.__kb.hasOwnProperty(t)||(e.__kb[t]=r),e.__kb[t]}},{key:"has",value:function(e,t){return e.__kb&&e.__kb.hasOwnProperty(t)}},{key:"wrappedObservable",value:function(e,t){return 1===arguments.length?a.utils.get(e,"observable"):a.utils.set(e,"observable",t)}},{key:"wrappedObject",value:function(e,t){return 1===arguments.length?a.utils.get(e,"object"):a.utils.set(e,"object",t)}},{key:"wrappedCreator",value:function(e,t){return 1===arguments.length?a.utils.get(e,"creator"):a.utils.set(e,"creator",t)}},{key:"wrappedModel",value:function(e,t){return 1!==arguments.length?a.utils.set(e,"object",t):(t=a.utils.get(e,"object"),o.isUndefined(t)?e:t)}},{key:"wrappedStore",value:function(e,t){return 1===arguments.length?a.utils.get(e,"store"):a.utils.set(e,"store",t)}},{key:"wrappedStoreIsOwned",value:function(e,t){return 1===arguments.length?a.utils.get(e,"store_is_owned"):a.utils.set(e,"store_is_owned",t)}},{key:"wrappedFactory",value:function(e,t){return 1===arguments.length?a.utils.get(e,"factory"):a.utils.set(e,"factory",t)}},{key:"wrappedEventWatcher",value:function(e,t){return 1===arguments.length?a.utils.get(e,"event_watcher"):a.utils.set(e,"event_watcher",t)}},{key:"wrappedEventWatcherIsOwned",value:function(e,t){return 1===arguments.length?a.utils.get(e,"event_watcher_is_owned"):a.utils.set(e,"event_watcher_is_owned",t)}},{key:"valueType",value:function(e){return e?e.__kb_is_o?e.valueType():e.__kb_is_co||e instanceof a.Collection?a.TYPE_COLLECTION:e instanceof a.ViewModel||e instanceof a.Model?a.TYPE_MODEL:o.isArray(e)?a.TYPE_ARRAY:a.TYPE_SIMPLE:a.TYPE_UNKNOWN}},{key:"pathJoin",value:function(e,t){return(e?"."!==e[e.length-1]?e+".":e:"")+t}},{key:"optionsPathJoin",value:function(e,t){return o.defaults({path:this.pathJoin(e.path,t)},e)}},{key:"inferCreator",value:function(e,t,r){var n=t?t.creatorForPath(e,r):null;return n?n:e?e instanceof a.Model?a.ViewModel:e instanceof a.Collection?a.CollectionObservable:null:null}},{key:"createFromDefaultCreator",value:function(e,t){return a.isModel(e)?a.viewModel(e,t):a.isCollection(e)?a.collectionObservable(e,t):o.isArray(e)?s.observableArray(e):s.observable(e)}},{key:"resolveModel",value:function(e){return e&&a.Backbone&&a.Backbone.ModelRef&&e instanceof a.Backbone.ModelRef?e.model():e}}]),e}();l.initClass(),a.utils=l},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko,l=function(e,t){var r=e.__kb.internals&&~o.indexOf(e.__kb.internals,t)?"_"+t:t;if(!e.__kb.view_model.hasOwnProperty(r))return e.__kb.view_model[r]=null,r},u=function(e,t,r,n){var i=void 0;if((!e.__kb.excludes||!~o.indexOf(e.__kb.excludes,r))&&(!e.__kb.statics||!~o.indexOf(e.__kb.statics,r))&&(i=l(e,r)))return e[i]=e.__kb.view_model[i]=a.observable(t,r,n,e)},c=function(e,t){o.each(e.__kb.statics,function(r){var n=void 0;(n=l(e,r))&&(t.has(n)?e[n]=e.__kb.view_model[n]=t.get(n):e.__kb.static_defaults&&n in e.__kb.static_defaults?e[n]=e.__kb.view_model[n]=e.__kb.static_defaults[n]:delete e.__kb.view_model[n])})},f=["keys","internals","excludes","statics","static_defaults"],d=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};arguments[2];n(this,e);var l=Array.prototype.slice.call(o.isArguments(t)?t:arguments);return a.ignore(function(){!(t=l.shift())||a.isModel(t)||a._throwUnexpected(r,"not a model"),o.isArray(l[0])&&(l[0]={keys:l[0]}),r.__kb||(r.__kb={}),r.__kb.view_model=l.length>1?l.pop():r,i={},o.each(l,function(e){a.assign(i,e),i=a.utils.collapseOptions(i)}),o.each(f,function(e){i.hasOwnProperty(e)&&(r.__kb[e]=i[e])}),a.Store.useOptionsOrCreate(i,t,r),r.__kb.path=i.path,a.Factory.useOptionsOrCreate(i,r,i.path);var e=a.utils.set(r,"_model",s.observable());r.model=s.computed({read:function(){return s.utils.unwrapObservable(e)},write:function(t){return a.ignore(function(){if(a.utils.wrappedObject(r)!==t&&!a.wasReleased(r)&&n)return r.__kb.store.reuse(r,a.utils.resolveModel(t)),n.emitter(t),e(n.ee),!n.ee||r.createObservables(n.ee)})}});var n=a.utils.wrappedEventWatcher(r,new a.EventWatcher(t,r,{emitter:r._model,update:function(){return a.ignore(function(){return!(null!=n?n.ee:void 0)||r.createObservables(null!=n?n.ee:void 0)})}}));return a.utils.wrappedObject(r,t=n.ee),e(n.ee),r.__kb.create_options={store:a.utils.wrappedStore(r),factory:a.utils.wrappedFactory(r),path:r.__kb.path,event_watcher:a.utils.wrappedEventWatcher(r)},!i.requires||r.createObservables(t,i.requires),!r.__kb.internals||r.createObservables(t,r.__kb.internals),!i.mappings||r.createObservables(t,i.mappings),!r.__kb.statics||c(r,t),r.createObservables(t,r.__kb.keys),a.statistics&&a.statistics.register("ViewModel",r),r})}return i(e,null,[{key:"initClass",value:function(){e.extend=a.Parse?a.Parse._extend:a.Model.extend}}]),i(e,[{key:"destroy",value:function(){var e=this;this.__kb_released=!0,this.__kb.view_model!==this&&function(){var t=[];for(var r in e.__kb.vm_keys)t.push(e.__kb.view_model[r]=null);t}(),this.__kb.view_model=null,this.__kb.create_options=null,a.releaseKeys(this),a.utils.wrappedDestroy(this),a.statistics&&a.statistics.unregister("ViewModel",this)}},{key:"shareOptions",value:function(){return{store:a.utils.wrappedStore(this),factory:a.utils.wrappedFactory(this)}}},{key:"createObservables",value:function(e,t){var r=this,n=void 0;if(t)if(o.isArray(t))o.map(t,function(t){return u(r,e,t,r.__kb.create_options)});else for(n in t){var i,s=t[n];(i=l(this,n))&&(o.isString(s)||s.key||(s.key=i),this[i]=this.__kb.view_model[i]=a.observable(e,s,this.__kb.create_options,this))}else{if(this.__kb.keys||!e)return;for(n in e.attributes)u(this,e,n,this.__kb.create_options);a.settings.orm&&a.settings.orm.keys&&o.each(a.settings.orm.keys,function(t){return u(r,e,t,r.__kb.create_options)})}}}]),e}();d.initClass(),a.ViewModel=d,e.exports=d,a.viewModel=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(a.ViewModel,[null].concat(t)))}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko;r(25);var l=["destroy","setToDefault"],u=function(){function e(t,r){var i=this;n(this,e),this.dv=r;var u=a.utils.wrappedObservable(this,s.computed({read:function(){var e=s.utils.unwrapObservable(t());return o.isNull(e)||o.isUndefined(e)?s.utils.unwrapObservable(i.dv):e},write:function(e){return t(e)}}));return a.publishMethods(u,this,l),u}return i(e,[{key:"destroy",value:function(){return a.utils.wrappedDestroy(this)}},{key:"setToDefault",value:function(){return a.utils.wrappedObservable(this)(this.dv)}}]),e}();a.DefaultObservable=u,e.exports=u,a.defaultObservable=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(a.DefaultObservable,[null].concat(t)))},a.observableDefault=a.defaultObservable},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko;a.toFormattedString=function(e){for(var t=e.slice(),r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return o.each(n,function(r,n){var i=s.utils.unwrapObservable(r);(o.isUndefined(i)||o.isNull(i))&&(i="");for(var a=e.indexOf("{"+n+"}");~a;)t=t.replace("{"+n+"}",i),a=e.indexOf("{"+n+"}",a+1)}),t},a.parseFormattedString=function(e,t){for(var r=t.slice(),n=0,i=0,a={};r.search("\\{"+n+"\\}")>=0;){for(var s=t.indexOf("{"+n+"}");~s;)r=r.replace("{"+n+"}","(.*)"),a[s]=n,i++,s=t.indexOf("{"+n+"}",s+1);n++}var l=n,u=new RegExp(r),c=u.exec(e);if(c&&c.shift(),!c||c.length!==i){for(var f=[];l-- >0;)f.push("");return f}var d=o.sortBy(o.keys(a),function(e){return+e}),v={};o.each(d,function(e,t){e=d[t],(n=a[e])in v||(v[n]=t)});var _=[];for(n=0;n<l;)_.push(c[v[n]]),n++;return _};var l=function(){function e(t){for(var r=arguments.length,i=Array(r>1?r-1:0),l=1;l<r;l++)i[l-1]=arguments[l];n(this,e);var u=o.isArray(i[0])?i[0]:i;return a.utils.wrappedObservable(this,s.computed({read:function(){return i=[s.utils.unwrapObservable(t)],o.each(u,function(e){return i.push(s.utils.unwrapObservable(e))}),a.toFormattedString.apply(null,i)},write:function(e){for(var r=a.parseFormattedString(e,s.utils.unwrapObservable(t)),n=Math.min(u.length,r.length),i=0;i<n;)u[i](r[i]),i++}}))}return i(e,[{key:"destroy",value:function(){return a.utils.wrappedDestroy(this)}}]),e}();a.FormattedObservable=l,e.exports=l,a.formattedObservable=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(a.FormattedObservable,[null].concat(t)))},a.observableFormatted=a.formattedObservable},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko,l=["destroy","observedValue","resetToCurrent"];a.locale_manager||(a.locale_manager=void 0);var u=function(){function e(t,r,i){var u=this;n(this,e);var c=void 0;this.value=t,this.vm=i,r||(r={}),this.vm||(this.vm={}),this.read||a._throwMissing(this,"read"),a.locale_manager||a._throwMissing(this,"kb.locale_manager"),this.__kb||(this.__kb={}),this.__kb._onLocaleChange=o.bind(this._onLocaleChange,this),this.__kb._onChange=r.onChange,this.value&&(c=s.utils.unwrapObservable(this.value)),this.vo=s.observable(c?this.read(c,null):null);var f=a.utils.wrappedObservable(this,s.computed({read:function(){return u.value&&s.utils.unwrapObservable(u.value),u.vo(),u.read(s.utils.unwrapObservable(u.value))},write:function(e){if(u.write||a._throwUnexpected(u,"writing to read-only"),u.write(e,s.utils.unwrapObservable(u.value)),u.vo(e),u.__kb._onChange)return u.__kb._onChange(e)},owner:this.vm}));return a.publishMethods(f,this,l),a.locale_manager.bind("change",this.__kb._onLocaleChange),r.hasOwnProperty("default")&&(f=a.DefaultObservable&&s.defaultObservable(f,r.default)),f}return i(e,null,[{key:"initClass",value:function(){e.extend=a.Parse?a.Parse._extend:a.Model.extend}}]),i(e,[{key:"destroy",value:function(){return a.locale_manager.unbind("change",this.__kb._onLocaleChange),this.vm=null,a.utils.wrappedDestroy(this)}},{key:"resetToCurrent",value:function(){var e=a.utils.wrappedObservable(this),t=this.value?this.read(s.utils.unwrapObservable(this.value)):null;if(e()!==t)return e(t)}},{key:"observedValue",value:function(e){if(0===arguments.length)return this.value;this.value=e,this._onLocaleChange()}},{key:"_onLocaleChange",value:function(){var e=this.read(s.utils.unwrapObservable(this.value));if(this.vo(e),this.__kb._onChange)return this.__kb._onChange(e)}}]),e}();u.initClass(),a.LocalizedObservable=u,e.exports=u,a.localizedObservable=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(a.LocalizedObservable,[null].concat(t)))},a.observableLocalized=a.localizedObservable},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.ko,l=["destroy"],u=function(){function e(t,r){var i=this;n(this,e),this.event_selector=r,t||a._throwMissing(this,"emitter"),this.event_selector||a._throwMissing(this,"event_selector"),this.vo=s.observable();var u=a.utils.wrappedObservable(this,s.computed(function(){return i.vo()}));return a.publishMethods(u,this,l),a.utils.wrappedEventWatcher(this,new a.EventWatcher(t,this,{emitter:o.bind(this.emitter,this),update:o.bind(this.update,this),event_selector:this.event_selector})),u}return i(e,[{key:"destroy",value:function(){return a.utils.wrappedDestroy(this)}},{key:"emitter",value:function(e){return 0===arguments.length||this.ee===e?this.ee:(this.ee=e,this.ee?this.update():void 0)}},{key:"update",value:function(){if(this.ee)return this.vo()!==this.ee?this.vo(this.ee):this.vo.valueHasMutated()}}]),e}();a.TriggeredObservable=u,e.exports=u,a.triggeredObservable=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(a.TriggeredObservable,[null].concat(t)))},a.observableTriggered=a.triggeredObservable},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=r(0),a=i._,o=i.ko;r(26);var s=function(e){e=o.utils.unwrapObservable(e);for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return"function"==typeof e?e.apply(void 0,r):e},l=function e(){n(this,e)};i.Validation=l,e.exports=l,i.valueValidator=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r&&"function"!=typeof r&&(r={}),o.computed(function(){var n={$error_count:0},i=o.utils.unwrapObservable(e),l=void 0;"disable"in r&&(l=s(r.disable)),"enable"in r&&(l=!s(r.enable));var u=r.priorities||[];a.isArray(u)||(u=[u]);var c=u.length+1;return a.each(t,function(e,t){if(n[t]=!l&&s(e,i),n[t]){var r=void 0;n.$error_count++,(r=a.indexOf(u,t)>=0)||(r=u.length),n.$active_error&&r<c?(n.$active_error=t,c=r):n.$active_error||(n.$active_error=t,c=r)}}),n.$enabled=!l,n.$disable=!!l,n.$valid=0===n.$error_count,n})},i.inputValidator=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r&&"function"!=typeof r&&(r={});var n=i.valid,o=t.getAttribute("name");o&&!a.isString(o)&&(o=null);var s=t.getAttribute("data-bind");if(!s)return null;var l=new Function("sc","with(sc[0]) { return { "+s+" } }")([e]);if(!l||!l.value)return null;l.validation_options&&(a.defaults(l.validation_options,r),r=l.validation_options);var u=t.getAttribute("type");s={},!n[u]||(s[u]=n[u]),!t.hasAttribute("required")||(s.required=n.required),l.validations&&a.each(l.validations,function(e,t){s[t]=e});var c=i.valueValidator(l.value,s,r);return!o&&!r.no_attach||(e["$"+o]=c),c},i.formValidator=function(e,t){var r={},n=[],s=t.getAttribute("name");s&&!a.isString(s)&&(s=null);var l=t.getAttribute("data-bind"),u=void 0;if(l){u=new Function("sc","with(sc[0]) { return { "+l+" } }")([e]).validation_options}return u||(u={}),u.no_attach=!!s,a.each(t.getElementsByTagName("input"),function(t){var a=t.getAttribute("name");if(a){var o=i.inputValidator(e,t,u);o&&n.push(r[a]=o)}}),r.$error_count=o.computed(function(){var e=0;return a.each(n,function(t){e+=t().$error_count}),e}),r.$valid=o.computed(function(){return 0===r.$error_count()}),r.$enabled=o.computed(function(){var e=!0;return a.each(n,function(t){e&=t().$enabled}),e}),r.$disabled=o.computed(function(){return!r.$enabled()}),s&&(e["$"+s]=r),r}},function(e,t,r){"use strict";var n=r(0),i=n._,a=function(e,t,r){return e[t]||(e[t]=[]),i.isArray(r)||(r=[r]),e[t]=e[t].length?i.union(e[t],r):r,e},o=function(e,t,r){return e[t]||(e[t]={}),n.assign(e[t],r)},s=function(e){var t={};return i.each(e,function(e){t[e]={key:e}}),t},l=function e(t,r){if(!r)return t;for(var n in r){var l=r[n];switch(n){case"internals":case"requires":case"excludes":case"statics":a(t,n,l);break;case"keys":i.isObject(l)&&!i.isArray(l)||i.isObject(t[n])&&!i.isArray(t[n])?(i.isObject(l)||(l=[l]),i.isArray(l)&&(l=s(l)),i.isArray(t[n])&&(t[n]=s(t[n])),o(t,n,l)):a(t,n,l);break;case"factories":i.isFunction(l)?t[n]=l:o(t,n,l);break;case"static_defaults":o(t,n,l);break;case"options":break;default:t[n]=l}}return e(t,r.options)};e.exports=function(e){return l({},e)}},function(e,t,r){"use strict";var n=r(0),i=n._,a=function e(t){if(!t)return t;if(t.__kb)return t.__kb.hasOwnProperty("object")?t.__kb.object:t;if(i.isArray(t))return i.map(t,function(t){return e(t)});if(i.isObject(t)&&t.constructor==={}.constructor){var r={};return i.each(t,function(t,n){r[n]=e(t)}),r}return t};e.exports=a},function(e,t,r){"use strict";var n=r(0),i=(n._,function e(t){if(t.__kb){t.__kb.event_watcher&&t.__kb.event_watcher.releaseCallbacks(t);var r=t.__kb;if(t.__kb=null,r.observable&&(r.observable.destroy=r.observable.release=null,e(r.observable),r.observable=null),r.factory=null,r.event_watcher_is_owned&&r.event_watcher.destroy(),r.event_watcher=null,r.store_is_owned&&r.store.destroy(),r.store=null,r.stores_references)for(var n=void 0;n=r.stores_references.pop();)n.store.__kb_released||n.store.release(t)}});e.exports=i},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.Backbone,l=null;e.exports=function(){function e(){n(this,e)}return i(e,null,[{key:"isAvailable",value:function(){return!!(l=s?s.AssociatedModel:null)}},{key:"keys",value:function(e){return e instanceof l?o.map(e.relations,function(e){return e.key}):null}},{key:"relationType",value:function(e,t){if(!(e instanceof l))return null;var r=o.find(e.relations,function(e){return e.key===t});return r?"Many"===r.type?a.TYPE_COLLECTION:a.TYPE_MODEL:null}},{key:"useFunction",value:function(){return!1}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=a._,s=a.Backbone,l=null;e.exports=function(){function e(){n(this,e)}return i(e,null,[{key:"isAvailable",value:function(){return!!(l=s?s.RelationalModel:null)}},{key:"relationType",value:function(e,t){if(!(e instanceof l))return null;var r=o.find(e.getRelations(),function(e){return e.key===t});return r?r.collectionType||o.isArray(r.keyContents)?a.TYPE_COLLECTION:a.TYPE_MODEL:null}},{key:"bind",value:function(e,t,r,n){var i=this.relationType(e,t);if(!i)return null;var s=function(e){return a.statistics&&a.statistics.addModelEvent({name:"update (relational)",model:e,key:t,path:n}),r()},l=a.Backbone.Relation.prototype.sanitizeOptions?["update","add","remove"]:["change","add","remove"];return i===a.TYPE_COLLECTION?o.each(l,function(r){return e.bind(r+":"+t,s)}):e.bind(l[0]+":"+t,s),function(){i===a.TYPE_COLLECTION?o.each(l,function(r){return e.unbind(r+":"+t,s)}):e.unbind(l[0]+":"+t,s)}}},{key:"useFunction",value:function(){return!1}}]),e}()},function(e,t,r){"use strict";var n=r(0),i=n._,a=n.ko;n.Observable.prototype.setToDefault=function(){this.__kb_value&&this.__kb_value.setToDefault&&this.__kb_value.setToDefault()},n.ViewModel.prototype.setToDefault=function(){i.each(this.__kb.vm_keys,function(e){e.__kb_value&&e.__kb_value.setToDefault&&e.__kb_value.setToDefault()})},n.utils.setToDefault=function(e){var t=this;if(e)return a.isObservable(e)?"function"==typeof e.setToDefault&&e.setToDefault():i.isObject(e)&&i.each(e,function(e,r){!e||!a.isObservable(e)&&"function"==typeof e||"_"===r[0]&&!r.search("__kb")||t.setToDefault(e)}),e}},function(e,t,r){"use strict";var n=r(0),i=n._,a=n.ko,o=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,s=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,l=/^\s*(-|\+)?(\d+|(\d*(\.\d*)))\s*$/;n.valid={required:function(e){return!e},url:function(e){return!o.test(e)},email:function(e){return!s.test(e)},number:function(e){return!l.test(e)}},n.hasChangedFn=function(e){var t=null,r=null;return function(){var n=a.utils.unwrapObservable(e);return t!==n?(t=n,r=t?t.toJSON():null,!1):!(!t||!r)&&!i.isEqual(t.toJSON(),r)}},n.minLengthFn=function(e){return function(t){return!t||t.length<e}},n.uniqueValueFn=function(e,t,r){return function(n){var o=a.utils.unwrapObservable(e),s=a.utils.unwrapObservable(t),l=a.utils.unwrapObservable(r);return!!(o&&s&&l)&&!!i.find(l.models,function(e){return e!==o&&e.get(s)===n})}},n.untilTrueFn=function(e,t,r){var n=!1;return r&&a.isObservable(r)&&r.subscribe(function(){n=!1}),function(r){var i=a.utils.unwrapObservable(t);if(!i)return a.utils.unwrapObservable(e);var o=i(a.utils.unwrapObservable(r));return n|=!!o,n?o:a.utils.unwrapObservable(e)}},n.untilFalseFn=function(e,t,r){var n=!1;return r&&a.isObservable(r)&&r.subscribe(function(){n=!1}),function(r){var i=a.utils.unwrapObservable(t);if(!i)return a.utils.unwrapObservable(e);var o=i(a.utils.unwrapObservable(r));return n|=!o,n?o:a.utils.unwrapObservable(e)}}},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){r(4),r(1),r(5),r(6),r(8),r(0),r(9),r(10),r(11),r(12),r(2),r(13),r(14),r(15),r(16),r(17),r(18),r(19),e.exports=r(7)}])});