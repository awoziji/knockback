!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("underscore"),require("knockout"),require("backbone")):"function"==typeof define&&define.amd?define(["underscore","knockout","backbone"],t):"object"==typeof exports?exports.kb=t(require("underscore"),require("knockout"),require("backbone")):e.kb=t(e._,e.ko,e.Backbone)}(window,function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=15)}([function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return p});var n=r(1),a=r.n(n),i=r(3),o=r.n(i),l=r(2),s=r.n(l);function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d="undefined"!=typeof window?window:void 0!==e?e:void 0,_=["release","destroy","dispose"],p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"wasReleased",value:function(e){return!e||e.__kb_released}},{key:"isReleaseable",value:function(t,r){if(null==r&&(r=0),!t||t!==Object(t)||t.__kb_released)return!1;if(s.a.isObservable(t)||t instanceof e.ViewModel)return!0;if("function"==typeof t||e.isModel(t)||e.isCollection(t))return!1;for(var n=0,a=_.length;n<a;n++){if("function"==typeof t[_[n]])return!0}if(r>0)return!1;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=t[i];if("__kb"!==i&&e.isReleaseable(o,r+1))return!0}return!1}},{key:"release",value:function(t){if(e.isReleaseable(t))if(t.__kb_released=!0,a.a.isArray(t))a.a.each(t,function(r,n){e.isReleaseable(r)&&(t[n]=null,e.release(r))});else{var r=e.peek(t);if(s.a.isObservable(t)&&a.a.isArray(r))return t.__kb_is_co||t.__kb_is_o&&t.valueType()===e.TYPE_COLLECTION?void("function"==typeof t.destroy&&t.destroy()):(a.a.each(r,function(t,n){e.isReleaseable(t)&&(r[n]=null,e.release(t))}),void("function"==typeof t.dispose&&t.dispose()));for(var n=0,i=_.length;n<i;n++){var o=_[n];if("function"==typeof t[o])return void t[o].call(t)}s.a.isObservable(t)||this.releaseKeys(t)}}},{key:"releaseKeys",value:function(t){a.a.each(t,function(r,n){"__kb"!==n&&e.isReleaseable(r)&&(t[n]=null,e.release(r))})}},{key:"releaseOnNodeRemove",value:function(t,r){return t||e._throwUnexpected(this,"missing view model"),r||e._throwUnexpected(this,"missing node"),s.a.utils.domNodeDisposal.addDisposeCallback(r,function(){return e.release(t)})}},{key:"renderTemplate",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(d.document){var a=d.document.createElement("div"),i=s.a.renderTemplate(t,r,n,a,"replaceChildren");if(1===a.childNodes.length)a=a.childNodes[0];else if(a.childNodes.length)for(var o=0,l=a.childNodes.length,u=l>=0;u?o<=l:o>=l;u?o++:o--)try{s.a.storedBindingContextForNode(a,s.a.contextFor(a.childNodes[o]));break}catch(e){}return e.releaseOnNodeRemove(r,a),i.dispose(),r.afterRender&&!n.afterRender&&r.afterRender(a),a}"undefined"==typeof console||console.log("renderTemplate: document is undefined")}},{key:"applyBindings",value:function(t,r){if(d.document){if(r.length){var n=r;r=d.document.createElement("div"),a.a.each(n,function(e){return r.appendChild(e)})}return s.a.applyBindings(t,r),e.releaseOnNodeRemove(t,r),r}"undefined"==typeof console||console.log("renderTemplate: document is undefined")}},{key:"getValue",value:function(t,r,n){if(t)return n?t.get.apply(t,u(a.a.map([r].concat(n),function(t){return e.peek(t)}))):t.get(r)}},{key:"setValue",value:function(e,t,r){var n;if(e)return(n={})[t]=r,e.set(n)}},{key:"_throwMissing",value:function(e,t){throw new Error("".concat(a.a.isString(e)?e:e.constructor.name,": ").concat(t," is missing"))}},{key:"_throwUnexpected",value:function(e,t){throw new Error("".concat(a.a.isString(e)?e:e.constructor.name,": ").concat(t," is unexpected"))}},{key:"publishMethods",value:function(t,r,n){a.a.each(n,function(n){t[n]=e._.bind(r[n],r)})}},{key:"peek",value:function(t){return s.a.isObservable(t)?t.peek?t.peek():e.ignore(function(){return t()}):t}},{key:"isModel",value:function(e){return e&&(e instanceof o.a.Model||"function"==typeof e.get&&"function"==typeof e.bind)}},{key:"isCollection",value:function(e){return e&&e instanceof o.a.Collection}}],(r=null)&&c(t.prototype,r),n&&c(t,n),e}();f(p,"VERSION","2.0.0-alpha.1"),f(p,"TYPE_UNKNOWN",0),f(p,"TYPE_SIMPLE",1),f(p,"TYPE_ARRAY",2),f(p,"TYPE_MODEL",3),f(p,"TYPE_COLLECTION",4),f(p,"assign",a.a.assign||a.a.extend),f(p,"ignore",s.a.dependencyDetection&&s.a.dependencyDetection.ignore?s.a.dependencyDetection.ignore:function(e,t,r){var n=null;return s.a.computed(function(){n=e.apply(t,r||[])}).dispose(),n})}).call(this,r(9))},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){"use strict";r.d(t,"a",function(){return _});var n=r(1),a=r.n(n),i=r(3),o=r.n(i),l=r(2),s=r.n(l),u=r(0);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _=function(){function e(t,r,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"_onModelLoaded",function(e){i.ee=e,a.a.each(i.__kb.callbacks,function(t,r){t.model&&t.model!==e&&i._unbindCallbacks(r,t,!0),t.model||(t.model=e,e.bind(r,t.fn)),a.a.each(t.list,function(t){!t.unbind_fn&&u.a.settings.orm&&u.a.settings.orm.customBind&&(t.unbind_fn=u.a.settings.orm.customBind(e,t.key,t.update,t.path)),t.emitter&&t.emitter(e)})})}),d(this,"_onModelUnloaded",function(e){i.ee===e&&(i.ee=null,a.a.each(i.__kb.callbacks,function(e,t){return i._unbindCallbacks(t,e)}))}),d(this,"_unbindCallbacks",function(e,t,r){t.model&&(t.model.unbind(e,t.fn),t.model=null),a.a.each(t.list,function(e){e.unbind_fn&&(e.unbind_fn(),e.unbind_fn=null),!e.emitter||r||u.a.wasReleased(e.obj)||e.emitter(null)})}),this.__kb||(this.__kb={}),this.__kb.callbacks={},this.ee=null,n&&this.registerCallbacks(r,n),t&&this.emitter(t)}return f(e,null,[{key:"useOptionsOrCreate",value:function(t,r,n,a){return t.event_watcher?(t.event_watcher.emitter()!==r&&t.event_watcher.model_ref!==r&&u.a._throwUnexpected(this,"emitter not matching"),u.a.utils.wrappedEventWatcher(n,t.event_watcher).registerCallbacks(n,a)):(u.a.utils.wrappedEventWatcherIsOwned(n,!0),u.a.utils.wrappedEventWatcher(n,new e(r)).registerCallbacks(n,a))}}]),f(e,[{key:"destroy",value:function(){return this.emitter(null),this.__kb.callbacks=null,u.a.utils.wrappedDestroy(this)}},{key:"emitter",value:function(e){return 0===arguments.length||this.ee===e?this.ee:(this.model_ref&&(this.model_ref.unbind("loaded",this._onModelLoaded),this.model_ref.unbind("unloaded",this._onModelUnloaded),this.model_ref.release(),this.model_ref=null),o.a&&o.a.ModelRef&&e instanceof o.a.ModelRef?(this.model_ref=e,this.model_ref.retain(),this.model_ref.bind("loaded",this._onModelLoaded),this.model_ref.bind("unloaded",this._onModelUnloaded),e=this.model_ref.model()||null):delete this.model_ref,this.ee!==e&&(e?this._onModelLoaded(e):this._onModelUnloaded(this.ee)),e)}},{key:"registerCallbacks",value:function(e,t){var r=this;e||u.a._throwMissing(this,"obj"),t||u.a._throwMissing(this,"callback_info");var n=t.event_selector?t.event_selector.split(" "):["change"],i=this.ee;return a.a.each(n,function(n){if(n){var o=r.__kb.callbacks[n];o||(r.__kb.callbacks[n]={model:null,list:[],fn:function(e){a.a.each(o.list,function(t){t.update&&(e&&t.key&&e.hasChanged&&!e.hasChanged(s.a.utils.unwrapObservable(t.key))||(u.a.statistics&&u.a.statistics.addModelEvent({name:n,model:e,key:t.key,path:t.path}),t.update()))})}},o=r.__kb.callbacks[n]);var l=a.a.defaults({obj:e},t);o.list.push(l),i&&r._onModelLoaded(i)}}),this}},{key:"releaseCallbacks",value:function(e){var t=this;return this.ee=null,a.a.each(this.__kb.callbacks,function(r,n){return t._unbindCallbacks(n,r,u.a.wasReleased(e))}),delete this.__kb.callbacks}}]),e}()},function(e,t,r){"use strict";r.d(t,"b",function(){return b}),r.d(t,"c",function(){return v}),r.d(t,"a",function(){return h});var n=r(1),a=r.n(n),i=r(3),o=r.n(i),l=r(2),s=r.n(l),u=r(0);function c(e,t,r){return(c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&f(a,r.prototype),a}).apply(null,arguments)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p=["destroy","shareOptions","filters","comparator","sortAttribute","viewModelByModel","hasViewModels"],b=function(e,t){return a.a.isString(e)?e.localeCompare("".concat(t)):a.a.isString(t)?t.localeCompare("".concat(e)):e===t?0:e<t?-1:1},v=function(){function e(){for(var t=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_(this,"_onCollectionChange",function(e,r){return u.a.ignore(function(){if(!t.in_edit&&!u.a.wasReleased(t))switch(e){case"reset":t.auto_compact?t.compact():t._collection.notifySubscribers(t._collection());break;case"sort":case"resort":t._collection.notifySubscribers(t._collection());break;case"new":case"add":if(!t._selectModel(r))return;var n=u.a.utils.wrappedObservable(t),a=t._collection();if(!~a.indexOf(r))return;if(t.viewModelByModel(r))return;t.in_edit++;var i=t._comparator();if(i)n().push(t._createViewModel(r)),n.sort(i);else{var o=t._createViewModel(r);n.splice(a.indexOf(r),0,o)}t.in_edit--;break;case"remove":case"destroy":t._onModelRemove(r);break;case"change":if(!t._selectModel(r))return t._onModelRemove(r);if(!(t.models_only?r:t.viewModelByModel(r)))return t._onCollectionChange("add",r);var l=t._comparator();if(!l)return;t.in_edit++,u.a.utils.wrappedObservable(t).sort(l),t.in_edit--}})}),_(this,"_onObservableArrayChange",function(e){return u.a.ignore(function(){if(!t.in_edit){t.models_only&&e.length&&!u.a.isModel(e[0])&&u.a._throwUnexpected(t,"incorrect type passed"),t.models_only||!e.length||a.a.isObject(e[0])||u.a.isModel(e[0])||u.a._throwUnexpected(t,"incorrect type passed");var r=u.a.utils.wrappedObservable(t),n=u.a.peek(t._collection),i=u.a.peek(t._filters).length;if(n){var o,l=e;t.models_only?o=a.a.filter(e,function(e){return!i||t._selectModel(e)}):(!i||(l=[]),o=[],a.a.each(e,function(e){var r=u.a.utils.wrappedObject(e);if(i){if(!t._selectModel(r))return;l.push(e)}var n=t.create_options.store.find(r,t.create_options.creator);n&&n.constructor!==e.constructor&&u.a._throwUnexpected(t,"replacing different type of view model"),t.create_options.store.retain(e,r,t.create_options.creator),o.push(r)})),t.in_edit++,e.length===l.length||r(l),a.a.isEqual(n.models,o)||n.reset(o),t.in_edit--}}})}),u.a.ignore(function(){var e=null;e=u.a.isCollection(n[0])?n.shift():a.a.isArray(n[0])?new o.a.Collection(n.shift()):new o.a.Collection,a.a.isFunction(n[0])&&(n[0]={view_model:n[0]});var r={};a.a.each(n,function(e){u.a.assign(r,e),r=u.a.utils.collapseOptions(r)});var i=u.a.utils.wrappedObservable(t,s.a.observableArray([]));i.__kb_is_co=!0,t.in_edit=0,t.__kb||(t.__kb={}),(r=u.a.utils.collapseOptions(r)).auto_compact&&(t.auto_compact=!0),r.sort_attribute?t._comparator=s.a.observable(t._attributeComparator(r.sort_attribute)):t._comparator=s.a.observable(r.comparator),r.filters?t._filters=s.a.observableArray(a.a.isArray(r.filters)?r.filters:[r.filters]):t._filters=s.a.observableArray([]),t.create_options={store:u.a.Store.useOptionsOrCreate(r,e,i)};var l=t.create_options;return u.a.utils.wrappedObject(i,e),t.path=r.path,l.factory=u.a.utils.wrappedFactory(i,t._shareOrCreateFactory(r)),l.path=u.a.utils.pathJoin(r.path,"models"),l.creator=l.factory.creatorForPath(null,l.path),l.creator&&(t.models_only=l.creator.models_only),u.a.publishMethods(i,t,p),t._collection=s.a.observable(e),t.collection=s.a.computed({read:function(){return t._collection()},write:function(e){return u.a.ignore(function(){var r=t._collection();if(r!==e)return u.a.utils.wrappedObject(i,e),r&&r.unbind("all",t._onCollectionChange),e&&e.bind("all",t._onCollectionChange),t._collection(e)})}}),i.collection=t.collection,e&&e.bind("all",t._onCollectionChange),t._mapper=s.a.computed(function(){var e=t._comparator(),r=t._filters();r&&a.a.each(r,function(e){return s.a.utils.unwrapObservable(e)});var n,o,l=t._collection();t.in_edit||(i=u.a.utils.wrappedObservable(t),l&&(n=l.models),n&&0!==l.models.length?(n=a.a.filter(n,function(e){return!r.length||t._selectModel(e)}),o=e?a.a.map(n,function(e){return t._createViewModel(e)}).sort(e):t.models_only?r.length?n:n.slice():a.a.map(n,function(e){return t._createViewModel(e)})):o=[],t.in_edit++,i(o),t.in_edit--)}),i.subscribe(a.a.bind(t._onObservableArrayChange,t)),u.a.statistics&&u.a.statistics.register("CollectionObservable",t),i})}var t,r,n;return t=e,(r=[{key:"destroy",value:function(){this.__kb_released=!0;var e=u.a.utils.wrappedObservable(this),t=u.a.peek(this._collection);if(u.a.utils.wrappedObject(e,null),t){t.unbind("all",this._onCollectionChange);var r=u.a.peek(e);r.splice(0,r.length)}this.collection.dispose(),this.collection=null,this._collection=null,e.collection=null,this._mapper.dispose(),this._mapper=null,u.a.release(this._filters),this._filters=null,this._comparator(null),this._comparator=null,this.create_options=null,e.collection=null,u.a.utils.wrappedDestroy(this),u.a.statistics&&u.a.statistics.unregister("CollectionObservable",this)}},{key:"shareOptions",value:function(){var e=u.a.utils.wrappedObservable(this);return{store:u.a.utils.wrappedStore(e),factory:u.a.utils.wrappedFactory(e)}}},{key:"filters",value:function(e){return e?this._filters(a.a.isArray(e)?e:[e]):this._filters([])}},{key:"comparator",value:function(e){return this._comparator(e)}},{key:"sortAttribute",value:function(e){return this._comparator(e?this._attributeComparator(e):null)}},{key:"viewModelByModel",value:function(e){if(this.models_only)return null;var t=Object.prototype.hasOwnProperty.call(e,e.idAttribute)?e.idAttribute:"cid";return a.a.find(u.a.peek(u.a.utils.wrappedObservable(this)),function(r){return r&&r.__kb&&r.__kb.object[t]===e[t]})}},{key:"hasViewModels",value:function(){return!this.models_only}},{key:"compact",value:function(){var e=this;return u.a.ignore(function(){var t=u.a.utils.wrappedObservable(e);if(u.a.utils.wrappedStoreIsOwned(t))return u.a.utils.wrappedStore(t).clear(),e._collection.notifySubscribers(e._collection())})}},{key:"_shareOrCreateFactory",value:function(e){var t=u.a.utils.pathJoin(e.path,"models"),r=e.factories,n=e.factory;if(n){var a=n.creatorForPath(null,t);if(a&&(!r||r.models===a)){if(!r)return n;if(n.hasPathMappings(r,e.path))return n}}return n=new u.a.Factory(e.factory),r&&n.addPathMappings(r,e.path),n.creatorForPath(null,t)||(Object.prototype.hasOwnProperty.call(e,"models_only")?e.models_only?n.addPathMapping(t,{models_only:!0}):n.addPathMapping(t,u.a.ViewModel):e.view_model?n.addPathMapping(t,e.view_model):e.create?n.addPathMapping(t,{create:e.create}):n.addPathMapping(t,u.a.ViewModel)),n}},{key:"_onModelRemove",value:function(e){var t=this.models_only?e:this.viewModelByModel(e);if(t){var r=u.a.utils.wrappedObservable(this);return this.in_edit++,r.remove(t),this.in_edit--}}},{key:"_attributeComparator",value:function(e){var t=function(t,r){var n=s.a.utils.unwrapObservable(e);return b(t.get(n),r.get(n))};return this.models_only?t:function(e,r){return t(u.a.utils.wrappedModel(e),u.a.utils.wrappedModel(r))}}},{key:"_createViewModel",value:function(e){return this.models_only?e:this.create_options.store.retainOrCreate(e,this.create_options)}},{key:"_selectModel",value:function(e){for(var t=u.a.peek(this._filters),r=0,n=t.length;r<n;r++){var i=t[r];if(i=u.a.peek(i),a.a.isFunction(i)){if(!i(e))return!1}else if(a.a.isArray(i)){if(!~i.indexOf(e.id))return!1}else if(e.id!==i)return!1}return!0}}])&&d(t.prototype,r),n&&d(t,n),e}();_(v,"extend",o.a.Model.extend);var h=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return c(v,t)}},function(e,t,r){"use strict";r.d(t,"b",function(){return a});var n=r(0),a={orm:null};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.a.assign(a,e)}},function(e,t,r){"use strict";r.d(t,"a",function(){return m}),r.d(t,"b",function(){return g});var n=r(1),a=r.n(n),i=r(3),o=r.n(i),l=r(2),s=r.n(l),u=r(0),c=r(4);function f(e,t,r){return(f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&d(a,r.prototype),a}).apply(null,arguments)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p,b,v,h=function(e,t){var r=e.__kb.internals&&~a.a.indexOf(e.__kb.internals,t)?"_".concat(t):t;if(!Object.prototype.hasOwnProperty.call(e.__kb.view_model,r))return e.__kb.view_model[r]=null,r},y=function(e,t,r,n){if(!(e.__kb.excludes&&~a.a.indexOf(e.__kb.excludes,r)||e.__kb.statics&&~a.a.indexOf(e.__kb.statics,r))){var i=h(e,r);if(i){var o=u.a.observable(t,r,n,e);return e.__kb.view_model[i]=o,e[i]=o,o}}},k=function(e,t){a.a.each(e.__kb.statics,function(r){var n=h(e,r);n&&(t.has(n)?(e.__kb.view_model[n]=t.get(n),e[n]=e.__kb.view_model[n]):e.__kb.static_defaults&&Object.prototype.hasOwnProperty.call(e.__kb.static_defaults,n)?(e.__kb.view_model[n]=e.__kb.static_defaults[n],e[n]=e.__kb.view_model[n]):delete e.__kb.view_model[n])})},w=["keys","internals","excludes","statics","static_defaults"],m=function(){function e(){for(var t=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u.a.ignore(function(){var e=n.shift();!e||u.a.isModel(e)||u.a._throwUnexpected(t,"not a model"),a.a.isArray(n[0])&&(n[0]={keys:n[0]}),t.__kb||(t.__kb={}),t.__kb.view_model=n.length>1?n.pop():t;var r={};a.a.each(n,function(e){u.a.assign(r,e),r=u.a.utils.collapseOptions(r)}),a.a.each(w,function(e){Object.prototype.hasOwnProperty.call(r,e)&&(t.__kb[e]=r[e])}),u.a.Store.useOptionsOrCreate(r,e,t),t.__kb.path=r.path,u.a.Factory.useOptionsOrCreate(r,t,r.path);var i=u.a.utils.wrappedEventWatcher(t,new c.a(e,t,{emitter:t._model,update:function(){return u.a.ignore(function(){return!(i&&i.ee)||t.createObservables(i.ee)})}})),o=u.a.utils.set(t,"_model",s.a.observable());return t.model=s.a.computed({read:function(){return s.a.utils.unwrapObservable(o)},write:function(e){return u.a.ignore(function(){if(u.a.utils.wrappedObject(t)!==e&&!u.a.wasReleased(t)&&i)return t.__kb.store.reuse(t,u.a.utils.resolveModel(e)),i.emitter(e),o(i.ee),!i.ee||t.createObservables(i.ee)})}}),e=i.ee,u.a.utils.wrappedObject(t,e),o(i.ee),t.__kb.create_options={store:u.a.utils.wrappedStore(t),factory:u.a.utils.wrappedFactory(t),path:t.__kb.path,event_watcher:u.a.utils.wrappedEventWatcher(t)},!r.requires||t.createObservables(e,r.requires),!t.__kb.internals||t.createObservables(e,t.__kb.internals),!r.mappings||t.createObservables(e,r.mappings),!t.__kb.statics||k(t,e),t.createObservables(e,t.__kb.keys),u.a.statistics&&u.a.statistics.register("ViewModel",t),t})}var t,r,n;return t=e,(r=[{key:"destroy",value:function(){var e=this;this.__kb_released=!0,this.__kb.view_model!==this&&a.a.each(this.__kb.vm_keys,function(t){e.__kb.view_model[t]=null}),this.__kb.view_model=null,this.__kb.create_options=null,u.a.releaseKeys(this),u.a.utils.wrappedDestroy(this),u.a.statistics&&u.a.statistics.unregister("ViewModel",this)}},{key:"shareOptions",value:function(){return{store:u.a.utils.wrappedStore(this),factory:u.a.utils.wrappedFactory(this)}}},{key:"createObservables",value:function(e,t){var r=this;if(t)a.a.isArray(t)?a.a.map(t,function(t){return y(r,e,t,r.__kb.create_options)}):a.a.each(t,function(t,n){var i=h(r,n);i&&(a.a.isString(t)||t.key||(t.key=i),r[i]=u.a.observable(e,t,r.__kb.create_options,r),r.__kb.view_model[i]=r[i])});else{if(this.__kb.keys||!e)return;for(var n in e.attributes)Object.prototype.hasOwnProperty.call(e.attributes,n)&&y(this,e,n,this.__kb.create_options);u.a.settings.orm&&u.a.settings.orm.keys&&a.a.each(u.a.settings.orm.keys(e),function(t){y(r,e,t,r.__kb.create_options)})}}}])&&_(t.prototype,r),n&&_(t,n),e}();p=m,b="extend",v=o.a.Model.extend,b in p?Object.defineProperty(p,b,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[b]=v;var g=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return f(m,t)}},function(e,t,r){"use strict";var n=r(1),a=r.n(n),i=r(2),o=r.n(i),l=r(0);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.create_options=t,this._vo=o.a.observable(null)}var t,r,n;return t=e,(r=[{key:"destroy",value:function(){this.__kb_released=!0;var e=this.__kb_value;e&&(this.__kb_value=null,this.create_options.store&&l.a.utils.wrappedCreator(e)?this.create_options.store.release(e):l.a.release(e)),this.create_options=null}},{key:"value",value:function(){return o.a.utils.unwrapObservable(this._vo())}},{key:"rawValue",value:function(){return this.__kb_value}},{key:"valueType",value:function(e,t){var r=l.a.getValue(e,t);return this.value_type||this._updateValueObservable(r),this.value_type}},{key:"update",value:function(e){if(!this.__kb_released){void 0!==e||(e=null);var t=l.a.utils.valueType(e);this.__kb_value&&this.__kb_value.__kb_released&&(this.__kb_value=void 0,this.value_type=void 0);var r=this.__kb_value;switch(this.value_type){case l.a.TYPE_COLLECTION:if(this.value_type===l.a.TYPE_COLLECTION&&t===l.a.TYPE_ARRAY)return r(e);if(t===l.a.TYPE_COLLECTION||a.a.isNull(e))return void(e&&e instanceof l.a.CollectionObservable?this._updateValueObservable(l.a.utils.wrappedObject(e),e):l.a.peek(r.collection)!==e&&r.collection(e));break;case l.a.TYPE_MODEL:if(t===l.a.TYPE_MODEL||a.a.isNull(e))return void(e&&!l.a.isModel(e)?this._updateValueObservable(l.a.utils.wrappedObject(e),e):l.a.utils.wrappedObject(r)!==l.a.utils.resolveModel(e)&&this._updateValueObservable(e))}if(this.value_type!==t||a.a.isUndefined(this.value_type)){if(l.a.peek(r)!==e)return this._updateValueObservable(e)}else if(l.a.peek(r)!==e)return r(e)}}},{key:"_updateValueObservable",value:function(e,t){var r=this.create_options,n=l.a.utils.inferCreator(e,r.factory,r.path);null!==e||n||(this.value_type===l.a.TYPE_MODEL?n=l.a.ViewModel:this.value_type===l.a.TYPE_COLLECTION&&(n=l.a.CollectionObservable)),r.creator=n;var i,s=l.a.TYPE_UNKNOWN,u=this.__kb_value;return this.__kb_value=void 0,t?(i=t,r.store&&r.store.retain(t,e,n)):n?r.store?i=r.store.retainOrCreate(e,r,!0):n.models_only?(i=e,s=l.a.TYPE_SIMPLE):i=n.create?n.create(e,r):new n(e,r):a.a.isArray(e)?(s=l.a.TYPE_ARRAY,i=o.a.observableArray(e)):(s=l.a.TYPE_SIMPLE,i=o.a.observable(e)),this.value_type=s,s===l.a.TYPE_UNKNOWN&&(o.a.isObservable(i)?i.__kb_is_co?(this.value_type=l.a.TYPE_COLLECTION,l.a.utils.wrappedObject(i,e)):this.value_type||(this.value_type=l.a.TYPE_SIMPLE):(this.value_type=l.a.TYPE_MODEL,l.a.utils.wrappedObject(i,l.a.utils.resolveModel(e)))),u&&(this.create_options.store?this.create_options.store.release(u):l.a.release(u)),this.__kb_value=i,this._vo(i)}}])&&s(t.prototype,r),n&&s(t,n),e}(),c=r(4);function f(e,t,r){return(f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&d(a,r.prototype),a}).apply(null,arguments)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.d(t,"a",function(){return v}),r.d(t,"b",function(){return h});var p=["value","valueType","destroy"],b=["args","read","write"],v=function(){function e(t,r,n,i){var s=this;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==i&&(i={}),this._vm=i,l.a.ignore(function(){r||l.a._throwMissing(s,"key_or_info"),s.key=r.key||r,a.a.map(b,function(e){r[e]&&(s[e]=r[e])});var e=l.a.utils.collapseOptions(n),i=e.event_watcher;delete e.event_watcher,s._value=new u(e),s._model=o.a.observable();var f=l.a.utils.wrappedObservable(s,o.a.computed({read:function(){var e=s._model(),t=[s.key].concat(s.args||[]);a.a.each(t,function(e){return o.a.utils.unwrapObservable(e)});var r=l.a.utils.wrappedEventWatcher(s);return!r||r.emitter(e||null),s.read?s.update(s.read.apply(s._vm,t)):a.a.isUndefined(e)||l.a.ignore(function(){return s.update(l.a.getValue(e,l.a.peek(s.key),s.args))}),s._value.value()},write:function(e){return l.a.ignore(function(){var t=l.a.utils.unwrapModels(e),r=l.a.peek(s._model);return s.write?(s.write.call(s._vm,t),e=l.a.getValue(r,l.a.peek(s.key),s.args)):r&&l.a.setValue(r,l.a.peek(s.key),t),s.update(e)})},owner:s._vm}));return f.__kb_is_o=!0,e.store=l.a.utils.wrappedStore(f,e.store),e.path=l.a.utils.pathJoin(e.path,s.key),e.factories&&("function"==typeof e.factories||e.factories.create)?(e.factory=l.a.utils.wrappedFactory(f,new l.a.Factory(e.factory)),e.factory.addPathMapping(e.path,e.factories)):e.factory=l.a.Factory.useOptionsOrCreate(e,f,e.path),delete e.factories,l.a.publishMethods(f,s,p),s.model=o.a.computed({read:function(){return o.a.utils.unwrapObservable(s._model)},write:function(e){return l.a.ignore(function(){if(!s.__kb_released&&l.a.peek(s._model)!==e){var t=l.a.getValue(e,l.a.peek(s.key),s.args);return s._model(e),e?a.a.isUndefined(t)?void 0:s.update(t):s.update(null)}})}}),f.model=s.model,c.a.useOptionsOrCreate({event_watcher:i},t||null,s,{emitter:s.model,update:function(){return l.a.ignore(function(){return s.update()})},key:s.key,path:e.path}),s._value.rawValue()||s._value.update(),l.a.LocalizedObservable&&r.localizer&&(f=new r.localizer(f)),l.a.DefaultObservable&&Object.prototype.hasOwnProperty.call(r,"default")&&(f=l.a.defaultObservable(f,r.default)),f})}var t,r,n;return t=e,(r=[{key:"destroy",value:function(){var e=l.a.utils.wrappedObservable(this);return this.__kb_released=!0,this._value.destroy(),this._value=null,this.model.dispose(),this.model=null,e.model=null,l.a.utils.wrappedDestroy(this)}},{key:"value",value:function(){return this._value.rawValue()}},{key:"valueType",value:function(){return this._value.valueType(l.a.peek(this._model),l.a.peek(this.key))}},{key:"update",value:function(e){if(!this.__kb_released)return arguments.length||(e=l.a.getValue(l.a.peek(this._model),l.a.peek(this.key))),this._value.update(e)}}])&&_(t.prototype,r),n&&_(t,n),e}(),h=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return f(v,t)}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.d(t,"a",function(){return s});var n=r(1),a=r.n(n),i=r(0);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.paths={},t&&(this.parent_factory=t)}return l(e,null,[{key:"useOptionsOrCreate",value:function(e,t,r){if(e.factory&&(!e.factories||e.factories&&e.factory.hasPathMappings(e.factories,r)))return i.a.utils.wrappedFactory(t,e.factory);var n=i.a.utils.wrappedFactory(t,new i.a.Factory(e.factory));return e.factories&&n.addPathMappings(e.factories,r),n}}]),l(e,[{key:"hasPath",value:function(e){return!(!Object.prototype.hasOwnProperty.call(this.paths,e)||!this.parent_factory)&&this.parent_factory.hasPath(e)}},{key:"addPathMapping",value:function(e,t){this.paths[e]=t}},{key:"addPathMappings",value:function(e,t){var r=this;a.a.each(e,function(e,n){r.paths[i.a.utils.pathJoin(t,n)]=e})}},{key:"hasPathMappings",value:function(e,t){var r=!0;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=e[n],o=this.creatorForPath(null,i.a.utils.pathJoin(t,n));r&=o&&a===o}return r}},{key:"creatorForPath",value:function(e,t){var r=this.paths[t];return r?r.view_model?r.view_model:r:this.parent_factory?this.parent_factory.creatorForPath(e,t):null}}]),e}()},function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return f});var n=r(1),a=r.n(n),i=r(2),o=r.n(i),l=r(0),s=void 0,u="undefined"!=typeof window?window:void 0!==e?e:void 0,c=function e(t,r,n,i,o,s){var u=function(t){return a.a.isFunction(t)?(r=new t(r,n,i,o),l.a.releaseOnNodeRemove(r,n)):(t.view_model&&(r=new t.view_model(r,n,i,o),l.a.releaseOnNodeRemove(r,n)),a.a.each(t,function(t,l){if("view_model"!==l)if("create"===l)t(r,n,i,o);else if(a.a.isObject(t)&&!a.a.isFunction(t)){var u=s||t&&t.create?{}:r;r[l]=e(t,u,n,i,o,!0)}else r[l]=t})),r};return s?u(t):l.a.ignore(function(){return u(t)})};o.a.bindingHandlers.inject={init:function(e,t,r,n){return c(o.a.utils.unwrapObservable(t()),n,e,t,r)}};var f=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.document,r=[];if(!t.__kb_injected){var n=a.a.find(t.attributes||[],function(e){return"kb-inject"===e.name});if(n){t.__kb_injected=!0;var i={el:t,view_model:{},binding:n.value};!function(e){var t={},r=null,n=null,a=e.binding;if(a){!~a.search(/[:]/)||(a="{".concat(a,"}"));var i=new Function("","return ( ".concat(a," )"))()||{};i.options&&(t=i.options,delete i.options),e.view_model=c(i,e.view_model,e.el,null,null,!0),r=e.view_model.afterBinding||t.afterBinding,n=e.view_model.beforeBinding||t.beforeBinding}n&&n.call(e.view_model,e.view_model,e.el,t),l.a.applyBindings(e.view_model,e.el,t),r&&r.call(e.view_model,e.view_model,e.el,t)}(i),r.push(i)}}return a.a.each(t.childNodes,function(t){var n=e(t);n.length&&a.a.each(n,function(e){return r.push(e)})}),r},d=o.a.applyBindings;if(o.a.applyBindings=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[1],a=l.a.RECUSIVE_AUTO_INJECT?f(n):[];return a.length?a:d.call.apply(d,[s].concat(t))},u&&void 0!==u.document){!function e(){return"complete"!==u.document.readyState?setTimeout(e,0):f()}()}}).call(this,r(9))},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(1),a=r.n(n);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model_events_tracker=[],this.registered_tracker={}}var t,r,n;return t=e,n=[{key:"eventsStats",value:function(e,t){var r={count:0},n=e._events||e._callbacks||{},i=t?[t]:a.a.keys(n);return a.a.each(i,function(e){var t=n[e];if(t){if(a.a.isArray(t))r[e]=a.a.compact(t).length;else{var i=t.tail;for(r[e]=0,t=t.next;t!==i;)r[e]++,t=t.next}r.count+=r[e]}}),r}}],(r=[{key:"clear",value:function(){this.model_events_tracker=[]}},{key:"addModelEvent",value:function(e){this.model_events_tracker.push(e)}},{key:"modelEventsStatsString",value:function(){var e="";e+="Total Count: ".concat(this.model_events_tracker.length);var t=a.a.groupBy(this.model_events_tracker,function(e){return"event name: '".concat(e.name,"', attribute name: '").concat(e.key,"'")});return a.a.each(t,function(t,r){e+="\n ".concat(r,", count: ").concat(t.length)}),e}},{key:"register",value:function(e,t){this.registeredTracker(e).push(t)}},{key:"unregister",value:function(e,t){var r=this.registeredTracker(e),n=a.a.indexOf(r,t);if(~n)return r.splice(n,1);"undefined"!=typeof console&&console.log("kb.Statistics: failed to unregister type: ".concat(e))}},{key:"registeredCount",value:function(e){if(e)return this.registeredTracker(e).length;var t=0;return a.a.each(this.registered_tracker[e],function(e){t+=e.length}),t}},{key:"registeredStatsString",value:function(e){var t="",r=!1;return a.a.each(this.registered_tracker,function(e,n){e.length&&(r&&(t+="\n "),t+="".concat(n||"No Name",": ").concat(e.length),r=!0)}),t||e}},{key:"registeredTracker",value:function(e){if(Object.prototype.hasOwnProperty.call(this.registered_tracker,e))return this.registered_tracker[e];var t=[];return this.registered_tracker[e]=t,t}}])&&i(t.prototype,r),n&&i(t,n),e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return _});var n=r(1),a=r.n(n),i=r(2),o=r.n(i),l=r(0);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}var c,f,d,_=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observable_records={},this.replaced_observables=[],l.a.Store.instances.push(this)}return u(e,null,[{key:"useOptionsOrCreate",value:function(e,t,r){e.store||l.a.utils.wrappedStoreIsOwned(r,!0);var n=l.a.utils.wrappedStore(r,e.store||new l.a.Store);return n.retain(r,t,e.creator),n}}]),u(e,[{key:"destroy",value:function(){this.__kb_released=!0,this.clear();var e=a.a.indexOf(l.a.Store.instances,this);~e&&l.a.Store.instances.splice(e,1)}},{key:"clear",value:function(){var e=this,t=this.observable_records;this.observable_records={},a.a.each(t,function(t){a.a.each(t,function(t){return e.release(t,!0)})});var r=this.replaced_observables;this.replaced_observables=[],a.a.each(r,function(t){t.__kb_released||e.release(t,!0)})}},{key:"compact",value:function(){a.a.each(this.observable_records,function(e){a.a.each(e,function(t,r){t.__kb_released&&delete e[r]})})}},{key:"retain",value:function(e,t,r){if(this._canRegister(e)){r||(r=e.constructor);var n=this.find(t,r);if(n){if(n===e)return this._getOrCreateStoreReferences(e).ref_count++,e;this._retire(n)}return this._add(e,t,r),this._getOrCreateStoreReferences(e).ref_count++,e}}},{key:"retainOrCreate",value:function(e,t,r){var n=this,i=this._creator(e,t);if(!i)return l.a.utils.createFromDefaultCreator(e,t);if(i.models_only)return e;var s=this.find(e,i);if(s)return r&&l.a.settings.deep_retain?this.retain(s,e,i):s;if(!a.a.isFunction(i.create||i))throw new Error('Invalid factory for "'.concat(t.path,'"'));return s=l.a.ignore(function(){return t=a.a.defaults({store:n,creator:i},t),(s=i.create?i.create(e,t):new i(e,t))||o.a.observable(null)}),this.retain(s,e,i),s}},{key:"reuse",value:function(e,t){var r=l.a.utils.wrappedObject(e);if(r!==t){if(!this._canRegister(e))throw new Error("Cannot reuse a simple observable");if(1!==this._refCount(e))throw new Error("Trying to change a shared view model. Ref count: ".concat(this._refCount(e)));var n,i=l.a.utils.wrappedCreator(e)||e.constructor;a.a.isUndefined(r)||(n=this.find(r,i)),this.retain(e,t,i),n&&this.release(n)}}},{key:"release",value:function(e,t){if(!this._canRegister(e))return l.a.release(e);var r=this._storeReferences(e);if(r){if(!t&&--r.ref_count>0)return;this._clearStoreReferences(e)}return this._remove(e),e.__kb_released?void 0:t||this._refCount(e)<=1?l.a.release(e):void 0}},{key:"find",value:function(e,t){var r=this.observable_records[this._creatorId(t)];if(!r)return null;var n=r[this._cid(e)];return n&&n.__kb_released?(delete r[this._cid(e)],null):n}},{key:"_refCount",value:function(e){if(e.__kb_released)return"undefined"==typeof console||console.log("Observable already released"),0;var t=l.a.utils.get(e,"stores_references");return t?a.a.reduce(t,function(e,t){return e+t.ref_count},0):1}},{key:"_canRegister",value:function(e){return e&&!o.a.isObservable(e)&&!e.__kb_is_co}},{key:"_cid",value:function(e){return e?(e.cid||(e.cid=a.a.uniqueId("c")),e.cid):"null"}},{key:"_creatorId",value:function(e){var t=e.create||e;t.__kb_cids||(t.__kb_cids=[]);for(var r=0,n=t.__kb_cids.length;r<n;r++){var i=t.__kb_cids[r];if(i.create===t)return i.cid}var o={create:t,cid:a.a.uniqueId("kb")};return t.__kb_cids.push(o),o.cid}},{key:"_storeReferences",value:function(e){var t=this,r=l.a.utils.get(e,"stores_references");if(r)return a.a.find(r,function(e){return e.store===t})}},{key:"_getOrCreateStoreReferences",value:function(e){var t=this,r=l.a.utils.orSet(e,"stores_references",[]),n=a.a.find(r,function(e){return e.store===t});return n||r.push(n={store:this,ref_count:0,release:function(){return t.release(e)}}),n}},{key:"_clearStoreReferences",value:function(e){if(l.a.utils.orSet(e,"stores_references",[]))for(var t=0,r=e.__kb.stores_references.length;t<r;t++){if(e.__kb.stores_references[t].store===this){e.__kb.stores_references.splice(t,1);break}}}},{key:"_retire",value:function(e){return this._clearStoreReferences(e),this.replaced_observables.push(e),this._remove(e)}},{key:"_add",value:function(e,t,r){r||(r=e.constructor),l.a.utils.wrappedObject(e,t),l.a.utils.wrappedCreator(e,r);var n=this._creatorId(r);return this.observable_records[n]||(this.observable_records[n]={}),this.observable_records[n][this._cid(t)]=e,e}},{key:"_remove",value:function(e){var t=l.a.utils.wrappedCreator(e)||e.constructor,r=l.a.utils.wrappedObject(e),n=this.find(r,t);return n&&n===e&&delete this.observable_records[this._creatorId(t)][this._cid(r)],l.a.utils.wrappedObject(e,null),l.a.utils.wrappedCreator(e,null)}},{key:"_creator",value:function(e,t){if(t.creator)return t.creator;var r=l.a.utils.inferCreator(e,t.factory,t.path);return r||(l.a.isModel(e)?l.a.ViewModel:void 0)}}]),e}();d=[],(f="instances")in(c=_)?Object.defineProperty(c,f,{value:d,enumerable:!0,configurable:!0,writable:!0}):c[f]=d},function(e,t,r){"use strict";var n=r(1),a=r.n(n),i=r(3),o=r.n(i),l=r(2),s=r.n(l),u=r(0),c=function e(t){if(t.__kb){t.__kb.event_watcher&&t.__kb.event_watcher.releaseCallbacks(t);var r=t.__kb;if(t.__kb=null,r.observable&&(r.observable.destroy=null,r.observable.release=null,e(r.observable),r.observable=null),r.factory=null,r.event_watcher_is_owned&&r.event_watcher.destroy(),r.event_watcher=null,r.store_is_owned&&r.store.destroy(),r.store=null,r.stores_references)for(var n=r.stores_references.pop();n;)n.store.__kb_released||n.store.release(t),n=r.stores_references.pop()}},f=a.a.assign||a.a.extend,d=function(e,t,r){return e[t]||(e[t]=[]),a.a.isArray(r)||(r=[r]),e[t]=e[t].length?a.a.union(e[t],r):r,e},_=function(e,t,r){return e[t]||(e[t]={}),f(e[t],r)},p=function(e){var t={};return a.a.each(e,function(e){t[e]={key:e}}),t};function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",function(){return h});var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"get",value:function(e,t,r){return e.__kb&&Object.prototype.hasOwnProperty.call(e.__kb,t)?e.__kb[t]:r}},{key:"set",value:function(e,t,r){return(e.__kb||(e.__kb={}))[t]=r,r}},{key:"orSet",value:function(e,t,r){return e.__kb||(e.__kb={}),Object.prototype.hasOwnProperty.call(e.__kb,t)||(e.__kb[t]=r),e.__kb[t]}},{key:"has",value:function(e,t){return e.__kb&&Object.prototype.hasOwnProperty.call(e.__kb,t)}},{key:"wrappedObservable",value:function(e,t){return 1===arguments.length?u.a.utils.get(e,"observable"):u.a.utils.set(e,"observable",t)}},{key:"wrappedObject",value:function(e,t){return 1===arguments.length?u.a.utils.get(e,"object"):u.a.utils.set(e,"object",t)}},{key:"wrappedCreator",value:function(e,t){return 1===arguments.length?u.a.utils.get(e,"creator"):u.a.utils.set(e,"creator",t)}},{key:"wrappedModel",value:function(e,t){return 1!==arguments.length?u.a.utils.set(e,"object",t):(t=u.a.utils.get(e,"object"),a.a.isUndefined(t)?e:t)}},{key:"wrappedStore",value:function(e,t){return 1===arguments.length?u.a.utils.get(e,"store"):u.a.utils.set(e,"store",t)}},{key:"wrappedStoreIsOwned",value:function(e,t){return 1===arguments.length?u.a.utils.get(e,"store_is_owned"):u.a.utils.set(e,"store_is_owned",t)}},{key:"wrappedFactory",value:function(e,t){return 1===arguments.length?u.a.utils.get(e,"factory"):u.a.utils.set(e,"factory",t)}},{key:"wrappedEventWatcher",value:function(e,t){return 1===arguments.length?u.a.utils.get(e,"event_watcher"):u.a.utils.set(e,"event_watcher",t)}},{key:"wrappedEventWatcherIsOwned",value:function(e,t){return 1===arguments.length?u.a.utils.get(e,"event_watcher_is_owned"):u.a.utils.set(e,"event_watcher_is_owned",t)}},{key:"valueType",value:function(e){return e?e.__kb_is_o?e.valueType():e.__kb_is_co||u.a.isCollection(e)?u.a.TYPE_COLLECTION:e instanceof u.a.ViewModel||u.a.isModel(e)?u.a.TYPE_MODEL:a.a.isArray(e)?u.a.TYPE_ARRAY:u.a.TYPE_SIMPLE:u.a.TYPE_UNKNOWN}},{key:"pathJoin",value:function(e,t){return(e?"."!==e[e.length-1]?"".concat(e,"."):e:"")+t}},{key:"optionsPathJoin",value:function(e,t){return a.a.defaults({path:this.pathJoin(e.path,t)},e)}},{key:"inferCreator",value:function(e,t,r){var n=t?t.creatorForPath(e,r):null;return n||(e?e instanceof o.a.Model?u.a.ViewModel:e instanceof o.a.Collection?u.a.CollectionObservable:null:null)}},{key:"createFromDefaultCreator",value:function(e,t){return u.a.isModel(e)?u.a.viewModel(e,t):u.a.isCollection(e)?u.a.collectionObservable(e,t):a.a.isArray(e)?s.a.observableArray(e):s.a.observable(e)}},{key:"resolveModel",value:function(e){return e&&o.a&&o.a.ModelRef&&e instanceof o.a.ModelRef?e.model():e}}],(r=null)&&b(t.prototype,r),n&&b(t,n),e}();v(h,"wrappedDestroy",c),v(h,"collapseOptions",function(e){return function e(t,r){return r?(a.a.each(r,function(e,r){switch(r){case"internals":case"requires":case"excludes":case"statics":d(t,r,e);break;case"keys":a.a.isObject(e)&&!a.a.isArray(e)||a.a.isObject(t[r])&&!a.a.isArray(t[r])?(a.a.isObject(e)||(e=[e]),a.a.isArray(e)&&(e=p(e)),a.a.isArray(t[r])&&(t[r]=p(t[r])),_(t,r,e)):d(t,r,e);break;case"factories":a.a.isFunction(e)?t[r]=e:_(t,r,e);break;case"static_defaults":_(t,r,e);break;case"options":break;default:t[r]=e}}),e(t,r.options)):t}({},e)}),v(h,"unwrapModels",function(e){if(!e)return e;if(e.__kb)return Object.prototype.hasOwnProperty.call(e.__kb,"object")?e.__kb.object:e;if(a.a.isArray(e))return a.a.map(e,function(e){return unwrapModels(e)});if(a.a.isObject(e)&&e.constructor==={}.constructor){var t={};return a.a.each(e,function(e,r){t[r]=unwrapModels(e)}),t}return e})},function(e,t,r){"use strict";r.r(t),function(e){var t=r(1),n=r.n(t),a=r(3),i=r.n(a),o=r(2),l=r.n(o),s=(r(17),r(0)),u=r(5),c=r(6),f=r(4),d=r(10),_=r(11),p=r(8),b=r(12),v=r(13),h=r(14),y=r(7),k={_:n.a,Backbone:i.a,ko:l.a,CollectionObservable:u.c,collectionObservable:u.a,observableCollection:u.a,compare:u.b,configure:c.a,settings:c.b,EventWatcher:f.a,Factory:d.a,RECUSIVE_AUTO_INJECT:!0,injectViewModels:_.a,Observable:p.a,observable:p.b,Statistics:b.a,Store:v.a,utils:h.a,ViewModel:y.a,viewModel:y.b};s.a.assign(s.a,k),e.exports=s.a}.call(this,r(16)(e))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";var n=r(2),a=r.n(n),i=r(0);if(a.a.subscribable&&a.a.subscribable.fn&&a.a.subscribable.fn.extend){var o=a.a.subscribable.fn.extend;a.a.subscribable.fn.extend=function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=o.apply(this,r);if(a!==this&&i.a.isReleaseable(this)){var l=a.dispose;a.dispose=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return!l||l.apply(a,r),i.a.release(e)}}return a}}}])});